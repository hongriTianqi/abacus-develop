<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3.2.4: module_elecstate/module_charge/charge_extra.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">3.2.4
   &#160;<span id="projectnumber">2023-06-13</span>
   </div>
   <div id="projectbrief">Molecule Simulates the Future</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3787abb44c32a47c0777164827203343.html">module_elecstate</a></li><li class="navelem"><a class="el" href="dir_fb73a634cf30b294798452919370cd3d.html">module_charge</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">charge_extra.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="charge__extra_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef CHARGE_EXTRA_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define CHARGE_EXTRA_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="unitcell_8h.html">module_cell/unitcell.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="structure__factor_8h.html">module_hamilt_pw/hamilt_pwdft/structure_factor.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="charge_8h.html">charge.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// charge extrapolation method</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// written by Xiaohui 2014</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="classCharge__Extra.html">   14</a></span>&#160;<span class="keyword">class </span><a class="code" href="classCharge__Extra.html">Charge_Extra</a></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classCharge__Extra.html">Charge_Extra</a>();</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    ~<a class="code" href="classCharge__Extra.html">Charge_Extra</a>();</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//When Esolver is initialized, ucell.natom is not determined</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//As a result, data structures in Charge_Extra cannot be allocated</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">//This is a temporary solution by delaying the allocation</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">//But after ucell and Esolver are fully decoupled</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">//Init_CE will be removed and everything put back in the constructor</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">void</span> Init_CE(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nrxx);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">void</span> extrapolate_charge(<a class="code" href="classCharge.html">Charge</a>* chr, <a class="code" href="classStructure__Factor.html">Structure_Factor</a>* <a class="code" href="namespaceGlobalC.html#a1a5abf4c9f6c4ab19f0f65a82322428b">sf</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">void</span> update_all_dis(<span class="keyword">const</span> <a class="code" href="classUnitCell.html">UnitCell</a>&amp; <a class="code" href="namespaceGlobalC.html#ad13900463d5f46ae6dc8854de86b6198">ucell</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a7696ae6bb77cf2434c76e59fe0eb0172">   31</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespaceIons__Move__Basic.html#afafa0cf5c9a34d577ac34a5a3487cf74">istep</a> = 0;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a14a5bc7c2d7f4bc9c6338e90a8da7c8f">   32</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classCharge__Extra.html#a14a5bc7c2d7f4bc9c6338e90a8da7c8f">natom</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#ae5595a984ded2eb25fd4ae7b229e1ffa">   33</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classCharge__Extra.html#ae5595a984ded2eb25fd4ae7b229e1ffa">pot_order</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a01efdaef86e51e718b90e2b2a2e93764">   34</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classCharge__Extra.html#a01efdaef86e51e718b90e2b2a2e93764">rho_extr</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a05e4d9d1e27163eba6cafbf89e5d5463">   35</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classCharge__Extra.html#a05e4d9d1e27163eba6cafbf89e5d5463">omega_old</a>;    <span class="comment">// the old volume of the last step</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// for the second-order extrapolation</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#ad787f3ad2a56c4439077f013c394a691">   38</a></span>&#160;    <a class="code" href="classModuleBase_1_1Vector3.html">ModuleBase::Vector3&lt;double&gt;</a> *dis_old1 = <span class="keyword">nullptr</span>;    <span class="comment">// dis_old2 = pos_old1 - pos_old2</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a9f5df613dd942324d3e28fd7512ca9c5">   39</a></span>&#160;    <a class="code" href="classModuleBase_1_1Vector3.html">ModuleBase::Vector3&lt;double&gt;</a> *dis_old2 = <span class="keyword">nullptr</span>;    <span class="comment">// dis_old1 = pos_now - pos_old1</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a0f7d031bb2af6dd1024d30a46b24bdcf">   40</a></span>&#160;    <a class="code" href="classModuleBase_1_1Vector3.html">ModuleBase::Vector3&lt;double&gt;</a> *dis_now = <span class="keyword">nullptr</span>;     <span class="comment">// dis_now = pos_next - pos_now</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a543bfd09576e61d1164dc7a88f485f8e">   42</a></span>&#160;    <span class="keywordtype">double</span>** delta_rho1 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#a720dc45a33665121ab66a94ec6f683ab">   43</a></span>&#160;    <span class="keywordtype">double</span>** delta_rho2 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classCharge__Extra.html#aeced9ff88dbe81214bd499a9863cd06b">   45</a></span>&#160;    <span class="keywordtype">double</span> alpha,<a class="code" href="classCharge__Extra.html#aeced9ff88dbe81214bd499a9863cd06b">beta</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">void</span> find_alpha_and_beta(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;};</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassCharge_html_ad4c6b165624d0f671f674c3737fd3c28"><div class="ttname"><a href="classCharge.html#ad4c6b165624d0f671f674c3737fd3c28">Charge::rhopw</a></div><div class="ttdeci">ModulePW::PW_Basis * rhopw</div><div class="ttdef"><b>Definition:</b> charge.h:93</div></div>
<div class="ttc" id="aclassUnitCell_html"><div class="ttname"><a href="classUnitCell.html">UnitCell</a></div><div class="ttdef"><b>Definition:</b> unitcell.h:18</div></div>
<div class="ttc" id="aclassStructure__Factor_html_af035223e48adb009e005fda2ca05935b"><div class="ttname"><a href="classStructure__Factor.html#af035223e48adb009e005fda2ca05935b">Structure_Factor::strucFac</a></div><div class="ttdeci">ModuleBase::ComplexMatrix strucFac</div><div class="ttdef"><b>Definition:</b> structure_factor.h:26</div></div>
<div class="ttc" id="aglobal_8h_html"><div class="ttname"><a href="global_8h.html">global.h</a></div></div>
<div class="ttc" id="aclassCharge_html_a7f532c4eb8ab8838833d4a7d94998ae0"><div class="ttname"><a href="classCharge.html#a7f532c4eb8ab8838833d4a7d94998ae0">Charge::atomic_rho</a></div><div class="ttdeci">void atomic_rho(const int spin_number_need, const double &amp;omega, double **rho_in, const ModuleBase::ComplexMatrix &amp;strucFac, const UnitCell &amp;ucell) const</div><div class="ttdef"><b>Definition:</b> charge.cpp:218</div></div>
<div class="ttc" id="anamespaceIons__Move__Basic_html_afafa0cf5c9a34d577ac34a5a3487cf74"><div class="ttname"><a href="namespaceIons__Move__Basic.html#afafa0cf5c9a34d577ac34a5a3487cf74">Ions_Move_Basic::istep</a></div><div class="ttdeci">int istep</div><div class="ttdef"><b>Definition:</b> ions_move_basic.cpp:10</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a56fac5ef41039cfe1e8b2759e10f2525"><div class="ttname"><a href="classCharge__Extra.html#a56fac5ef41039cfe1e8b2759e10f2525">Charge_Extra::update_all_dis</a></div><div class="ttdeci">void update_all_dis(const UnitCell &amp;ucell)</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:306</div></div>
<div class="ttc" id="aclassModuleBase_1_1matrix_html_a37ea41ac31fc5329f07fc4765bd5a582"><div class="ttname"><a href="classModuleBase_1_1matrix.html#a37ea41ac31fc5329f07fc4765bd5a582">ModuleBase::matrix::c</a></div><div class="ttdeci">double * c</div><div class="ttdef"><b>Definition:</b> matrix.h:25</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_a408eebe4f1a75f40817fd0a22b932b95"><div class="ttname"><a href="classCharge__Mixing.html#a408eebe4f1a75f40817fd0a22b932b95">Charge_Mixing::deallocate_Broyden</a></div><div class="ttdeci">void deallocate_Broyden()</div><div class="ttdef"><b>Definition:</b> charge_broyden.cpp:163</div></div>
<div class="ttc" id="astructure__factor_8h_html"><div class="ttname"><a href="structure__factor_8h.html">structure_factor.h</a></div></div>
<div class="ttc" id="aclassCharge__Extra_html_ab545a8e2ae0bad32d3123aa1e6a5a50c"><div class="ttname"><a href="classCharge__Extra.html#ab545a8e2ae0bad32d3123aa1e6a5a50c">Charge_Extra::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdef"><b>Definition:</b> charge_extra.h:45</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aa21d3bb9a3dd12f2b025fb31ff8cd0ee"><div class="ttname"><a href="namespaceGlobalV.html#aa21d3bb9a3dd12f2b025fb31ff8cd0ee">GlobalV::NSPIN</a></div><div class="ttdeci">int NSPIN</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:40</div></div>
<div class="ttc" id="anamespaceModuleBase_1_1GlobalFunc_html_ae14c43041594db3a042c9ce69a6caeb9"><div class="ttname"><a href="namespaceModuleBase_1_1GlobalFunc.html#ae14c43041594db3a042c9ce69a6caeb9">ModuleBase::GlobalFunc::OUT</a></div><div class="ttdeci">void OUT(std::ofstream &amp;ofs, const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> global_function.cpp:51</div></div>
<div class="ttc" id="aclassCharge__Extra_html"><div class="ttname"><a href="classCharge__Extra.html">Charge_Extra</a></div><div class="ttdef"><b>Definition:</b> charge_extra.h:14</div></div>
<div class="ttc" id="aclassAtom_html"><div class="ttname"><a href="classAtom.html">Atom</a></div><div class="ttdef"><b>Definition:</b> atom_spec.h:6</div></div>
<div class="ttc" id="aclassStructure__Factor_html"><div class="ttname"><a href="classStructure__Factor.html">Structure_Factor</a></div><div class="ttdef"><b>Definition:</b> structure_factor.h:10</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_aaf86e8d08ce087ca40f8dc2e455017be"><div class="ttname"><a href="classCharge__Mixing.html#aaf86e8d08ce087ca40f8dc2e455017be">Charge_Mixing::mixing_beta</a></div><div class="ttdeci">double mixing_beta</div><div class="ttdef"><b>Definition:</b> charge_mixing.h:71</div></div>
<div class="ttc" id="ainverse__matrix_8h_html"><div class="ttname"><a href="inverse__matrix_8h.html">inverse_matrix.h</a></div></div>
<div class="ttc" id="anamespaceModuleBase_1_1libm_html_a53ba939830541970fa8cdc6973c806e5"><div class="ttname"><a href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">ModuleBase::libm::i</a></div><div class="ttdeci">int4 i[880]</div><div class="ttdef"><b>Definition:</b> sincos.cpp:28</div></div>
<div class="ttc" id="anamespaceModuleBase_html_a04d6e9eea9a131d0ccf54a74c65c0f71"><div class="ttname"><a href="namespaceModuleBase.html#a04d6e9eea9a131d0ccf54a74c65c0f71">ModuleBase::BLOCK_TASK_DIST_1D</a></div><div class="ttdeci">void BLOCK_TASK_DIST_1D(int nworker, int iworker, T_task ntask, T_task block_size, T_out &amp;start, T_out &amp;len)</div><div class="ttdef"><b>Definition:</b> tool_threading.h:42</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a543bfd09576e61d1164dc7a88f485f8e"><div class="ttname"><a href="classCharge__Extra.html#a543bfd09576e61d1164dc7a88f485f8e">Charge_Extra::delta_rho1</a></div><div class="ttdeci">double ** delta_rho1</div><div class="ttdef"><b>Definition:</b> charge_extra.h:42</div></div>
<div class="ttc" id="aclassModuleBase_1_1Vector3_html"><div class="ttname"><a href="classModuleBase_1_1Vector3.html">ModuleBase::Vector3&lt; double &gt;</a></div></div>
<div class="ttc" id="anamespaceGlobalV_html_ab5d3c7c55e12b45dcd87699f0c659098"><div class="ttname"><a href="namespaceGlobalV.html#ab5d3c7c55e12b45dcd87699f0c659098">GlobalV::ofs_warning</a></div><div class="ttdeci">std::ofstream ofs_warning</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:147</div></div>
<div class="ttc" id="anamespaceModuleBase_html_ad0b268ded393d31b0dd1a795366af4a6"><div class="ttname"><a href="namespaceModuleBase.html#ad0b268ded393d31b0dd1a795366af4a6">ModuleBase::TITLE</a></div><div class="ttdeci">void TITLE(const std::string &amp;class_name, const std::string &amp;function_name, const bool disable)</div><div class="ttdef"><b>Definition:</b> tool_title.cpp:18</div></div>
<div class="ttc" id="aclassCharge__Extra_html_aeced9ff88dbe81214bd499a9863cd06b"><div class="ttname"><a href="classCharge__Extra.html#aeced9ff88dbe81214bd499a9863cd06b">Charge_Extra::beta</a></div><div class="ttdeci">double beta</div><div class="ttdef"><b>Definition:</b> charge_extra.h:45</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a7696ae6bb77cf2434c76e59fe0eb0172"><div class="ttname"><a href="classCharge__Extra.html#a7696ae6bb77cf2434c76e59fe0eb0172">Charge_Extra::istep</a></div><div class="ttdeci">int istep</div><div class="ttdef"><b>Definition:</b> charge_extra.h:31</div></div>
<div class="ttc" id="aclassModuleBase_1_1Memory_html_aeb0ee609df8fc31710d8604e8d468ca9"><div class="ttname"><a href="classModuleBase_1_1Memory.html#aeb0ee609df8fc31710d8604e8d468ca9">ModuleBase::Memory::record</a></div><div class="ttdeci">static double record(const std::string &amp;class_name, const std::string &amp;name, const long &amp;n, const std::string &amp;type, const bool accumulate=false)</div><div class="ttdoc">Record memory consumed during computation.</div><div class="ttdef"><b>Definition:</b> memory.cpp:94</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_a7caa94c767c1be10d51ea9e9f331fb92"><div class="ttname"><a href="classCharge__Mixing.html#a7caa94c767c1be10d51ea9e9f331fb92">Charge_Mixing::Simplified_Broyden_mixing</a></div><div class="ttdeci">void Simplified_Broyden_mixing(const int &amp;iter, Charge *chr)</div><div class="ttdef"><b>Definition:</b> charge_broyden.cpp:10</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a0f84eb4e0b69c1e4a84c70bbefa70e1a"><div class="ttname"><a href="classCharge__Extra.html#a0f84eb4e0b69c1e4a84c70bbefa70e1a">Charge_Extra::~Charge_Extra</a></div><div class="ttdeci">~Charge_Extra()</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:11</div></div>
<div class="ttc" id="anamespaceGlobalC_html_ad13900463d5f46ae6dc8854de86b6198"><div class="ttname"><a href="namespaceGlobalC.html#ad13900463d5f46ae6dc8854de86b6198">GlobalC::ucell</a></div><div class="ttdeci">UnitCell ucell</div><div class="ttdef"><b>Definition:</b> klist_test.cpp:46</div></div>
<div class="ttc" id="aclassCharge_html_a056fbe36485bdaad061113ab102d66cb"><div class="ttname"><a href="classCharge.html#a056fbe36485bdaad061113ab102d66cb">Charge::rho</a></div><div class="ttdeci">double ** rho</div><div class="ttdef"><b>Definition:</b> charge.h:36</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a66a77bcd269db858c3bccb70810b288c"><div class="ttname"><a href="classCharge__Extra.html#a66a77bcd269db858c3bccb70810b288c">Charge_Extra::Init_CE</a></div><div class="ttdeci">void Init_CE(const int &amp;nrxx)</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:32</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a01efdaef86e51e718b90e2b2a2e93764"><div class="ttname"><a href="classCharge__Extra.html#a01efdaef86e51e718b90e2b2a2e93764">Charge_Extra::rho_extr</a></div><div class="ttdeci">int rho_extr</div><div class="ttdef"><b>Definition:</b> charge_extra.h:34</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_ace64ee88221d8ba19eefb8db729ad473"><div class="ttname"><a href="classCharge__Mixing.html#ace64ee88221d8ba19eefb8db729ad473">Charge_Mixing::mixing_ndim</a></div><div class="ttdeci">int mixing_ndim</div><div class="ttdef"><b>Definition:</b> charge_mixing.h:72</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aa6d884dbe6439646b8937a9171e9a8a3"><div class="ttname"><a href="namespaceGlobalV.html#aa6d884dbe6439646b8937a9171e9a8a3">GlobalV::ofs_running</a></div><div class="ttdeci">std::ofstream ofs_running</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:146</div></div>
<div class="ttc" id="aclassCharge__Extra_html_acdb6daa1cf37777c66f7118d3b821adf"><div class="ttname"><a href="classCharge__Extra.html#acdb6daa1cf37777c66f7118d3b821adf">Charge_Extra::find_alpha_and_beta</a></div><div class="ttdeci">void find_alpha_and_beta(void)</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:246</div></div>
<div class="ttc" id="aparallel__reduce_8h_html"><div class="ttname"><a href="parallel__reduce_8h.html">parallel_reduce.h</a></div></div>
<div class="ttc" id="aclassUnitCell_html_ac6743e54b55c4b646a69806b4d5f2ac5"><div class="ttname"><a href="classUnitCell.html#ac6743e54b55c4b646a69806b4d5f2ac5">UnitCell::omega</a></div><div class="ttdeci">double omega</div><div class="ttdef"><b>Definition:</b> unitcell.h:38</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_a5969d5f4d10bf99b101c8c1e9564af51"><div class="ttname"><a href="classCharge__Mixing.html#a5969d5f4d10bf99b101c8c1e9564af51">Charge_Mixing::allocate_Broyden</a></div><div class="ttdeci">void allocate_Broyden()</div><div class="ttdef"><b>Definition:</b> charge_broyden.cpp:137</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_a843e87cb3760ffb035b209bfba06b1ca"><div class="ttname"><a href="classCharge__Mixing.html#a843e87cb3760ffb035b209bfba06b1ca">Charge_Mixing::dn</a></div><div class="ttdeci">std::complex&lt; double &gt; *** dn</div><div class="ttdef"><b>Definition:</b> charge_mixing.h:142</div></div>
<div class="ttc" id="aclassAtom_html_a65c7183c3781d7d91e5d994ad634f659"><div class="ttname"><a href="classAtom.html#a65c7183c3781d7d91e5d994ad634f659">Atom::dis</a></div><div class="ttdeci">ModuleBase::Vector3&lt; double &gt; * dis</div><div class="ttdef"><b>Definition:</b> atom_spec.h:39</div></div>
<div class="ttc" id="aclassModuleBase_1_1timer_html_a7d5a9dd381e39259fb92b31a89140206"><div class="ttname"><a href="classModuleBase_1_1timer.html#a7d5a9dd381e39259fb92b31a89140206">ModuleBase::timer::tick</a></div><div class="ttdeci">static void tick(const std::string &amp;class_name_in, const std::string &amp;name_in)</div><div class="ttdoc">Use twice at a time: the first time, set start_flag to false; the second time, calculate the time dur...</div><div class="ttdef"><b>Definition:</b> timer.cpp:66</div></div>
<div class="ttc" id="anamespaceGlobalV_html_ad7b5fc3463375ebe9fdca4ccf2d208d6"><div class="ttname"><a href="namespaceGlobalV.html#ad7b5fc3463375ebe9fdca4ccf2d208d6">GlobalV::chg_extrap</a></div><div class="ttdeci">std::string chg_extrap</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:251</div></div>
<div class="ttc" id="atimer_8h_html"><div class="ttname"><a href="timer_8h.html">timer.h</a></div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_a0a5231435a0d95b3e0f28dbe6428d612"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#a0a5231435a0d95b3e0f28dbe6428d612">ModulePW::PW_Basis::nrxx</a></div><div class="ttdeci">int nrxx</div><div class="ttdef"><b>Definition:</b> pw_basis.h:117</div></div>
<div class="ttc" id="aunitcell_8h_html"><div class="ttname"><a href="unitcell_8h.html">unitcell.h</a></div></div>
<div class="ttc" id="aclassModuleBase_1_1matrix_html_abc8c011ec78c8d2f2cf98e69227314b0"><div class="ttname"><a href="classModuleBase_1_1matrix.html#abc8c011ec78c8d2f2cf98e69227314b0">ModuleBase::matrix::create</a></div><div class="ttdeci">void create(const int nrow, const int ncol, const bool flag_zero=true)</div><div class="ttdef"><b>Definition:</b> matrix.cpp:122</div></div>
<div class="ttc" id="alapack__connector_8h_html_aeed9e2b3c7f66c9b8058915f35d5d68e"><div class="ttname"><a href="lapack__connector_8h.html#aeed9e2b3c7f66c9b8058915f35d5d68e">dsytrf_</a></div><div class="ttdeci">void dsytrf_(const char *uplo, const int *n, double *a, const int *lda, int *ipiv, double *work, int *lwork, int *info)</div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_a3dbf762a3c3b282649614bd1cb89d801"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#a3dbf762a3c3b282649614bd1cb89d801">ModulePW::PW_Basis::npw</a></div><div class="ttdeci">int npw</div><div class="ttdef"><b>Definition:</b> pw_basis.h:112</div></div>
<div class="ttc" id="alapack__connector_8h_html_a53f72797c82bd68b4162802b9366bdd2"><div class="ttname"><a href="lapack__connector_8h.html#a53f72797c82bd68b4162802b9366bdd2">dsytri_</a></div><div class="ttdeci">void dsytri_(const char *uplo, const int *n, double *a, const int *lda, int *ipiv, double *work, int *info)</div></div>
<div class="ttc" id="aclassCharge_html_a4c447f7f777466a9b011429c6261f4c0"><div class="ttname"><a href="classCharge.html#a4c447f7f777466a9b011429c6261f4c0">Charge::rhog</a></div><div class="ttdeci">std::complex&lt; double &gt; ** rhog</div><div class="ttdef"><b>Definition:</b> charge.h:39</div></div>
<div class="ttc" id="acharge__mixing_8h_html"><div class="ttname"><a href="charge__mixing_8h.html">charge_mixing.h</a></div></div>
<div class="ttc" id="aglobal__function_8h_html"><div class="ttname"><a href="global__function_8h.html">global_function.h</a></div></div>
<div class="ttc" id="aclassUnitCell_html_a0ffb2085697159cf7630c18873016fa6"><div class="ttname"><a href="classUnitCell.html#a0ffb2085697159cf7630c18873016fa6">UnitCell::ntype</a></div><div class="ttdeci">int ntype</div><div class="ttdef"><b>Definition:</b> unitcell.h:30</div></div>
<div class="ttc" id="aglobal__variable_8h_html"><div class="ttname"><a href="global__variable_8h.html">global_variable.h</a></div></div>
<div class="ttc" id="aclassCharge__Mixing_html_ab1fb83be69bdf25ba0aaf5fdaebe5071"><div class="ttname"><a href="classCharge__Mixing.html#ab1fb83be69bdf25ba0aaf5fdaebe5071">Charge_Mixing::beta</a></div><div class="ttdeci">ModuleBase::matrix beta</div><div class="ttdef"><b>Definition:</b> charge_mixing.h:139</div></div>
<div class="ttc" id="acharge_8h_html"><div class="ttname"><a href="charge_8h.html">charge.h</a></div></div>
<div class="ttc" id="aclassCharge__Extra_html_ad787f3ad2a56c4439077f013c394a691"><div class="ttname"><a href="classCharge__Extra.html#ad787f3ad2a56c4439077f013c394a691">Charge_Extra::dis_old1</a></div><div class="ttdeci">ModuleBase::Vector3&lt; double &gt; * dis_old1</div><div class="ttdef"><b>Definition:</b> charge_extra.h:38</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a14a5bc7c2d7f4bc9c6338e90a8da7c8f"><div class="ttname"><a href="classCharge__Extra.html#a14a5bc7c2d7f4bc9c6338e90a8da7c8f">Charge_Extra::natom</a></div><div class="ttdeci">int natom</div><div class="ttdef"><b>Definition:</b> charge_extra.h:32</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_a8b3b365be955d98b527d05f53eb98e49"><div class="ttname"><a href="classCharge__Mixing.html#a8b3b365be955d98b527d05f53eb98e49">Charge_Mixing::rhog_dot_product</a></div><div class="ttdeci">double rhog_dot_product(const std::complex&lt; double &gt; *const *const rhog1, const std::complex&lt; double &gt; *const *const rhog2) const</div><div class="ttdef"><b>Definition:</b> charge_mixing.cpp:361</div></div>
<div class="ttc" id="acharge__extra_8h_html"><div class="ttname"><a href="charge__extra_8h.html">charge_extra.h</a></div></div>
<div class="ttc" id="aclassCharge__Extra_html_a0f7d031bb2af6dd1024d30a46b24bdcf"><div class="ttname"><a href="classCharge__Extra.html#a0f7d031bb2af6dd1024d30a46b24bdcf">Charge_Extra::dis_now</a></div><div class="ttdeci">ModuleBase::Vector3&lt; double &gt; * dis_now</div><div class="ttdef"><b>Definition:</b> charge_extra.h:40</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a1a5abf4c9f6c4ab19f0f65a82322428b"><div class="ttname"><a href="namespaceGlobalC.html#a1a5abf4c9f6c4ab19f0f65a82322428b">GlobalC::sf</a></div><div class="ttdeci">Structure_Factor sf</div><div class="ttdef"><b>Definition:</b> for_testing_input_conv.h:368</div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_abe30432b8c7a5a3bec170b18ddfae010"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#abe30432b8c7a5a3bec170b18ddfae010">ModulePW::PW_Basis::recip2real</a></div><div class="ttdeci">void recip2real(const std::complex&lt; FPTYPE &gt; *in, FPTYPE *out, const bool add=false, const FPTYPE factor=1.0) const</div><div class="ttdoc">transform reciprocal space to real space</div><div class="ttdef"><b>Definition:</b> pw_transform.cpp:194</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_a1e4a1d44c234afba5326762fa9912614"><div class="ttname"><a href="classCharge__Mixing.html#a1e4a1d44c234afba5326762fa9912614">Charge_Mixing::initb</a></div><div class="ttdeci">bool initb</div><div class="ttdef"><b>Definition:</b> charge_mixing.h:135</div></div>
<div class="ttc" id="aclassCharge__Extra_html_ae5595a984ded2eb25fd4ae7b229e1ffa"><div class="ttname"><a href="classCharge__Extra.html#ae5595a984ded2eb25fd4ae7b229e1ffa">Charge_Extra::pot_order</a></div><div class="ttdeci">int pot_order</div><div class="ttdef"><b>Definition:</b> charge_extra.h:33</div></div>
<div class="ttc" id="anamespaceModuleBase_html_a2681bf6cb4975b24a4263f23e1c4c679"><div class="ttname"><a href="namespaceModuleBase.html#a2681bf6cb4975b24a4263f23e1c4c679">ModuleBase::dot</a></div><div class="ttdeci">std::complex&lt; double &gt; dot(const ComplexArray &amp;cd1, const ComplexArray &amp;cd2)</div><div class="ttdoc">Take &quot;dot-product&quot; of two ComplexArray: sum of cd1(conjugate)[i] * cd2[i].</div><div class="ttdef"><b>Definition:</b> complexarray.cpp:218</div></div>
<div class="ttc" id="alapack__connector_8h_html"><div class="ttname"><a href="lapack__connector_8h.html">lapack_connector.h</a></div></div>
<div class="ttc" id="aclassCharge__Extra_html_a05e4d9d1e27163eba6cafbf89e5d5463"><div class="ttname"><a href="classCharge__Extra.html#a05e4d9d1e27163eba6cafbf89e5d5463">Charge_Extra::omega_old</a></div><div class="ttdeci">double omega_old</div><div class="ttdef"><b>Definition:</b> charge_extra.h:35</div></div>
<div class="ttc" id="abranred_8cpp_html_abb702d8b501669a23aa0ab3b281b9384"><div class="ttname"><a href="branred_8cpp.html#abb702d8b501669a23aa0ab3b281b9384">min</a></div><div class="ttdeci">#define min(x, y)</div><div class="ttdef"><b>Definition:</b> branred.cpp:18</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_ade8ad32427b8c795e369c169ba6f47e7"><div class="ttname"><a href="classCharge__Mixing.html#ade8ad32427b8c795e369c169ba6f47e7">Charge_Mixing::rhopw</a></div><div class="ttdeci">ModulePW::PW_Basis * rhopw</div><div class="ttdef"><b>Definition:</b> charge_mixing.h:78</div></div>
<div class="ttc" id="aclassUnitCell_html_aa2f36362705925bc69b705bf0d07b474"><div class="ttname"><a href="classUnitCell.html#aa2f36362705925bc69b705bf0d07b474">UnitCell::nat</a></div><div class="ttdeci">int nat</div><div class="ttdef"><b>Definition:</b> unitcell.h:31</div></div>
<div class="ttc" id="aclassCharge_html"><div class="ttname"><a href="classCharge.html">Charge</a></div><div class="ttdef"><b>Definition:</b> charge.h:17</div></div>
<div class="ttc" id="aclassModuleBase_1_1Vector3_html_a2eb1b82893764c1bd38a5993c6f6dcfb"><div class="ttname"><a href="classModuleBase_1_1Vector3.html#a2eb1b82893764c1bd38a5993c6f6dcfb">ModuleBase::Vector3::norm2</a></div><div class="ttdeci">T norm2(void) const</div><div class="ttdoc">Get the square of nomr of a Vector3.</div><div class="ttdef"><b>Definition:</b> vector3.h:167</div></div>
<div class="ttc" id="aclassCharge__Mixing_html_a90674aa1955af0da4807e52c4b699148"><div class="ttname"><a href="classCharge__Mixing.html#a90674aa1955af0da4807e52c4b699148">Charge_Mixing::dF</a></div><div class="ttdeci">std::complex&lt; double &gt; *** dF</div><div class="ttdef"><b>Definition:</b> charge_mixing.h:141</div></div>
<div class="ttc" id="aclassCharge_html_a43e6c50873a159ac0ceffd73ea533ba2"><div class="ttname"><a href="classCharge.html#a43e6c50873a159ac0ceffd73ea533ba2">Charge::rhog_save</a></div><div class="ttdeci">std::complex&lt; double &gt; ** rhog_save</div><div class="ttdef"><b>Definition:</b> charge.h:40</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a87a102c15e72f69bb32c7848b6d37488"><div class="ttname"><a href="classCharge__Extra.html#a87a102c15e72f69bb32c7848b6d37488">Charge_Extra::Charge_Extra</a></div><div class="ttdeci">Charge_Extra()</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:7</div></div>
<div class="ttc" id="aclassStructure__Factor_html_aa611bb425e012b3bf560beb17ca5cd96"><div class="ttname"><a href="classStructure__Factor.html#aa611bb425e012b3bf560beb17ca5cd96">Structure_Factor::setup_structure_factor</a></div><div class="ttdeci">void setup_structure_factor(UnitCell *Ucell, const ModulePW::PW_Basis *rho_basis)</div><div class="ttdef"><b>Definition:</b> structure_factor.cpp:56</div></div>
<div class="ttc" id="atool__threading_8h_html"><div class="ttname"><a href="tool__threading_8h.html">tool_threading.h</a></div></div>
<div class="ttc" id="aclassAtom_html_a5275f949b40661fbea4b21723b57eebf"><div class="ttname"><a href="classAtom.html#a5275f949b40661fbea4b21723b57eebf">Atom::na</a></div><div class="ttdeci">int na</div><div class="ttdef"><b>Definition:</b> atom_spec.h:29</div></div>
<div class="ttc" id="aclassCharge__Extra_html_ad0fe660c9bd6887fb04667c29948be22"><div class="ttname"><a href="classCharge__Extra.html#ad0fe660c9bd6887fb04667c29948be22">Charge_Extra::extrapolate_charge</a></div><div class="ttdeci">void extrapolate_charge(Charge *chr, Structure_Factor *sf)</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:82</div></div>
<div class="ttc" id="anamespaceModuleBase_html_a319c957fc399a519aa4cdd447bdee1aa"><div class="ttname"><a href="namespaceModuleBase.html#a319c957fc399a519aa4cdd447bdee1aa">ModuleBase::WARNING_QUIT</a></div><div class="ttdeci">void WARNING_QUIT(const std::string &amp;file, const std::string &amp;description)</div><div class="ttdoc">Combine the functions of WARNING and QUIT.</div><div class="ttdef"><b>Definition:</b> complexmatrix_test.cpp:46</div></div>
<div class="ttc" id="amemory_8h_html"><div class="ttname"><a href="memory_8h.html">memory.h</a></div></div>
<div class="ttc" id="aclassUnitCell_html_a1663e041da7d7f723cdf2b19d9d06efe"><div class="ttname"><a href="classUnitCell.html#a1663e041da7d7f723cdf2b19d9d06efe">UnitCell::atoms</a></div><div class="ttdeci">Atom * atoms</div><div class="ttdef"><b>Definition:</b> unitcell.h:21</div></div>
<div class="ttc" id="anamespaceModuleBase_1_1GlobalFunc_html_ab0d97a1e0e2c8216c3b1cc50cd735056"><div class="ttname"><a href="namespaceModuleBase_1_1GlobalFunc.html#ab0d97a1e0e2c8216c3b1cc50cd735056">ModuleBase::GlobalFunc::ZEROS</a></div><div class="ttdeci">void ZEROS(std::complex&lt; T &gt; *u, const TI n)</div><div class="ttdef"><b>Definition:</b> global_function.h:115</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a9f5df613dd942324d3e28fd7512ca9c5"><div class="ttname"><a href="classCharge__Extra.html#a9f5df613dd942324d3e28fd7512ca9c5">Charge_Extra::dis_old2</a></div><div class="ttdeci">ModuleBase::Vector3&lt; double &gt; * dis_old2</div><div class="ttdef"><b>Definition:</b> charge_extra.h:39</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a720dc45a33665121ab66a94ec6f683ab"><div class="ttname"><a href="classCharge__Extra.html#a720dc45a33665121ab66a94ec6f683ab">Charge_Extra::delta_rho2</a></div><div class="ttdeci">double ** delta_rho2</div><div class="ttdef"><b>Definition:</b> charge_extra.h:43</div></div>
<div class="ttc" id="anamespaceModuleBase_html_aa818ef3febfa7d41147bb7624097ce92"><div class="ttname"><a href="namespaceModuleBase.html#aa818ef3febfa7d41147bb7624097ce92">ModuleBase::OMP_PARALLEL</a></div><div class="ttdeci">void OMP_PARALLEL(const std::function&lt; void(int, int)&gt; &amp;f)</div><div class="ttdef"><b>Definition:</b> tool_threading.h:79</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
