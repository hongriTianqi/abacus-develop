<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3.1.1: module_hamilt_pw/hamilt_pwdft/stress_func.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="abacus-logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">3.1.1
   &#160;<span id="projectnumber">2023-02-01</span>
   </div>
   <div id="projectbrief">Molecule Simulates the Future</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a822a04b930ddb7289859d580981667f.html">module_hamilt_pw</a></li><li class="navelem"><a class="el" href="dir_d8b882ffc48ece6cf16435ffaebc9b0c.html">hamilt_pwdft</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">stress_func.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="stress__func_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef STRESS_FUNC_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define STRESS_FUNC_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="global__function_8h.html">module_base/global_function.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="global__variable_8h.html">module_base/global_variable.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="parallel__reduce_8h.html">src_parallel/parallel_reduce.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="matrix_8h.html">module_base/matrix.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="complexmatrix_8h.html">module_base/complexmatrix.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="realarray_8h.html">module_base/realarray.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vector3_8h.html">module_base/vector3.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pw__basis_8h.html">module_pw/pw_basis.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi_8h.html">module_psi/psi.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="charge_8h.html">module_elecstate/module_charge/charge.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="math__kernel__op_8h.html">module_hsolver/kernels/math_kernel_op.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="stress__op_8h.html">module_hamilt_pw/hamilt_pwdft/kernels/stress_op.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//-------------------------------------------------------------------</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// mohan reconstruction note: 2021-02-07</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// the stress code needs reconstructions (by Daye Zheng)</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// 1) add explanations for each function, each variable, for </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// main procedures, make the code readable</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// 2) divide the stress class into several files, each file</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// deals with only one part of the stress, it is convenient for </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// the next-step reconstruction, for example, we want to make </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// pw as an external variable instead of a global variable</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// 3) for PW and LCAO, keeps only one copy of the code, for example</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// the ewald term needs only one copy, it will reduce the </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// time to maintain both copies of stress codes.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// 4) remain openning interfaces for others to contribute stress</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// codes, for example, molecular dynamics will have an ionic stress</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// term, +U? exx? may have other stress terms.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// 5) delete useless comments and tests, if you have a useless code,</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// please explicitly explain why you want to keep the test</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// 6) format should be beautiful! code should be readable like a </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// note (let readers be comfortable)</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//-------------------------------------------------------------------</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//----------------------------------------------------------------</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// compute the stress terms in terms of the plane wave basis set</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// the stress terms include: </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// 1) the stress from the electron kinetic energy </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// 2) the stress from the local pseudopotentials</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// 3) the stress from the non-local pseudopotentials</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// 4) the stress from the Hartree term</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// 5) the stress from the non-linear core correction (if any)</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// 6) the strees from the exchange-correlation functional term</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// 7) the stress from the ewald term (ion-ion intraction under </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//      periodic boundary conditions). </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// 8) the stress from ionic contributions (for molecular dynamics)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//----------------------------------------------------------------</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> FPTYPE, <span class="keyword">typename</span> Device = psi::DEVICE_CPU&gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classStress__Func.html">   54</a></span>&#160;<span class="keyword">class </span><a class="code" href="classStress__Func.html">Stress_Func</a></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keyword">public</span>: </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classStress__Func.html#a1e296d156f33bd3235f89f78d8fe3a13">   58</a></span>&#160;    <a class="code" href="classStress__Func.html#a1e296d156f33bd3235f89f78d8fe3a13">Stress_Func</a>(){};</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classStress__Func.html#a50b50093a32d06c086fb6c15d5bc40f9">   59</a></span>&#160;    <a class="code" href="classStress__Func.html#a50b50093a32d06c086fb6c15d5bc40f9">~Stress_Func</a>(){};</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//stress functions</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// 1) the stress from the electron kinetic energy</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a581c9814b3e779edcba36cf3ff8097f1">stress_kin</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <span class="keyword">const</span> <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; wg, <span class="keyword">const</span> <a class="code" href="classpsi_1_1Psi.html">psi::Psi</a>&lt;complex&lt;FPTYPE&gt;&gt;* psi_in=<span class="keyword">nullptr</span>);  <span class="comment">//electron kinetic part in PW basis</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// 2) the stress from the Hartree term</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a124c45025fb8cdda7ff05c4bfd6a48bb">stress_har</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <a class="code" href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a>* rho_basis, <span class="keyword">const</span> <span class="keywordtype">bool</span> is_pw, <span class="keyword">const</span> <a class="code" href="classCharge.html">Charge</a>* <span class="keyword">const</span> chr);  <span class="comment">//hartree part in PW or LCAO basis</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// 3) the stress from the ewald term (ion-ion intraction under </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//      periodic boundary conditions). </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a123bfe3d6692f7863c5233b9d6f93215">stress_ewa</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <a class="code" href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a>* rho_basis, <span class="keyword">const</span> <span class="keywordtype">bool</span> is_pw);     <span class="comment">//ewald part in PW or LCAO basis</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">// 4) the stress from the local pseudopotentials</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a04e4fa436039813323bde6c2bfcb2d5f">stress_loc</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <a class="code" href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a>* rho_basis, <span class="keyword">const</span> <span class="keywordtype">bool</span> is_pw, <span class="keyword">const</span> <a class="code" href="classCharge.html">Charge</a>* <span class="keyword">const</span> chr);  <span class="comment">//local pseudopotential part in PW or LCAO</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a061fef4615b75d29e7354466972d75f2">dvloc_of_g</a> (<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; msh,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keyword">const</span> FPTYPE* rab,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keyword">const</span> FPTYPE* r,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keyword">const</span> FPTYPE* vloc_at,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keyword">const</span> FPTYPE&amp; zp,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            FPTYPE*  dvloc,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a>* rho_basis); <span class="comment">//used in local pseudopotential stress</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a670c5826121cb330454b8d47a22fac36">dvloc_coul</a> (<span class="keyword">const</span> FPTYPE&amp; zp, FPTYPE* dvloc, <a class="code" href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a>* rho_basis); <span class="comment">//used in local pseudopotential stress</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">// 5) the stress from the non-linear core correction (if any)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#afb4a91cc8729aa125799567996c3870c">stress_cc</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <a class="code" href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a>* rho_basis, <span class="keyword">const</span> <span class="keywordtype">bool</span> is_pw, <span class="keyword">const</span> <a class="code" href="classCharge.html">Charge</a>* <span class="keyword">const</span> chr);            <span class="comment">//nonlinear core correction stress in PW or LCAO basis</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a56db0ba4eff8f3f0a5281f1d78ba7362">deriv_drhoc</a> (</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;numeric,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> mesh,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keyword">const</span> FPTYPE *r,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keyword">const</span> FPTYPE *rab,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keyword">const</span> FPTYPE *rhoc,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            FPTYPE *drhocg,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a>* rho_basis); <span class="comment">//used in nonlinear core correction stress</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// 6) the stress from the exchange-correlation functional term</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a6fc9b89334a17ad363da53de60e88ea8">stress_gga</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <span class="keyword">const</span> <a class="code" href="classCharge.html">Charge</a>* <span class="keyword">const</span> chr);            <span class="comment">//gga part in both PW and LCAO basis</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a00cd2c8bf58fb4579fa89276e4767329">stress_mgga</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <span class="keyword">const</span> <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; wg, <span class="keyword">const</span> <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; v_ofk, <span class="keyword">const</span> <a class="code" href="classCharge.html">Charge</a>* <span class="keyword">const</span> chr, <span class="keyword">const</span> <a class="code" href="classpsi_1_1Psi.html">psi::Psi</a>&lt;complex&lt;FPTYPE&gt;&gt;* psi_in=<span class="keyword">nullptr</span>);           <span class="comment">//gga part in PW basis</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// 7) the stress from the non-local pseudopotentials</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a3872140813071a0b0f2c116f2e66c517">stress_nl</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; sigma, <span class="keyword">const</span> <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; wg, <span class="keyword">const</span> <a class="code" href="classpsi_1_1Psi.html">psi::Psi</a>&lt;complex&lt;FPTYPE&gt;, Device&gt;* psi_in=<span class="keyword">nullptr</span>);           <span class="comment">//nonlocal part in PW basis</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#ac65ce961e4ab45a1a099e5865f9d44d1">get_dvnl1</a>(</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <a class="code" href="classModuleBase_1_1ComplexMatrix.html">ModuleBase::ComplexMatrix</a> &amp;vkb,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ik,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ipol);    <span class="comment">//used in nonlocal part in PW basis</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#ab56632672a198791eb2eb94cbaafe733">dylmr2</a> (</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nylm,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ngy,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <a class="code" href="classModuleBase_1_1Vector3.html">ModuleBase::Vector3&lt;FPTYPE&gt;</a> *gk,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a> &amp;dylm,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ipol);    <span class="comment">//used in get_dvnl1()</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#abd558c6392aac372a1509345bfed1220">get_dvnl2</a>(</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <a class="code" href="classModuleBase_1_1ComplexMatrix.html">ModuleBase::ComplexMatrix</a> &amp;vkb,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ik);      <span class="comment">//used in nonlocal part in PW basis</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    FPTYPE <a class="code" href="classStress__Func.html#a6b372e8c27086b15272a7998ff2f90e1">Polynomial_Interpolation_nl</a>(</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keyword">const</span> <a class="code" href="classModuleBase_1_1realArray.html">ModuleBase::realArray</a> &amp;table,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;dim1,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;dim2,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keyword">const</span> FPTYPE &amp;table_interval,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keyword">const</span> FPTYPE &amp;<a class="code" href="namespaceModuleBase_1_1libm.html#a947b87f10e3327eefe6c05e187d544d6">x</a>);   <span class="comment">//used in get_dvnl2()</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">//functions for stress print</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a0ec0c4ec6ec0bfd4af78d5b1c21a14f0">print_stress</a>(<span class="keyword">const</span> std::string &amp;name, <span class="keyword">const</span> <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; f, <span class="keyword">const</span> <span class="keywordtype">bool</span> screen, <span class="keywordtype">bool</span> ry)<span class="keyword">const</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classStress__Func.html#a283a801fed548150170fa9626fc7c96a">printstress_total</a> (<span class="keyword">const</span> <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a>&amp; scs, <span class="keywordtype">bool</span> ry);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classStress__Func.html#a8321bc531e273ed3b268c1e397b790a7">  130</a></span>&#160;    <span class="keyword">static</span> FPTYPE <a class="code" href="classStress__Func.html#a8321bc531e273ed3b268c1e397b790a7">stress_invalid_threshold_ev</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classStress__Func.html#a50eb85c062f859d8589b292e7e9a6155">  131</a></span>&#160;    <span class="keyword">static</span> FPTYPE <a class="code" href="classStress__Func.html#a50eb85c062f859d8589b292e7e9a6155">output_acc</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classStress__Func.html#a9cd596f677abbca0995744fc15e5dc8d">  134</a></span>&#160;    Device * <a class="code" href="classStress__Func.html#a9cd596f677abbca0995744fc15e5dc8d">ctx</a> = {};</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classStress__Func.html#a50478a2cfc33d323e655d58460853d0f">  135</a></span>&#160;    psi::DEVICE_CPU * <a class="code" href="classStress__Func.html#a50478a2cfc33d323e655d58460853d0f">cpu_ctx</a> = {};</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classStress__Func.html#afbee9ab8ae59adc80732a946f0cd7449">  136</a></span>&#160;    <a class="code" href="namespacepsi.html#ad8c12890ff1eb1ec9ea924e8b8bf00e1">psi::AbacusDevice_t</a> <a class="code" href="classStress__Func.html#afbee9ab8ae59adc80732a946f0cd7449">device</a> = {};</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classStress__Func.html#a9b8ea890a65b801a0477d410aa31a52d">  137</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structhsolver_1_1gemm__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">gemm_op</a> = <a class="code" href="structhsolver_1_1gemm__op.html">hsolver::gemm_op&lt;FPTYPE, Device&gt;</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classStress__Func.html#abc30633b86e15412e21770aaf4f54fdf">  138</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structhamilt_1_1cal__stress__nl__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">cal_stress_nl_op</a> = <a class="code" href="structhamilt_1_1cal__stress__nl__op.html">hamilt::cal_stress_nl_op&lt;FPTYPE, Device&gt;</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classStress__Func.html#af2b8c446975d24feb7c3842925c5b1a9">  139</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structhamilt_1_1cal__dbecp__noevc__nl__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">cal_dbecp_noevc_nl_op</a> = <a class="code" href="structhamilt_1_1cal__dbecp__noevc__nl__op.html">hamilt::cal_dbecp_noevc_nl_op&lt;FPTYPE, Device&gt;</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classStress__Func.html#a8ea5d29da8f29e515064773b3aeb5e90">  141</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1resize__memory__op.html">resmem_complex_op</a> = <a class="code" href="structpsi_1_1memory_1_1resize__memory__op.html">psi::memory::resize_memory_op&lt;std::complex&lt;FPTYPE&gt;</a>, Device&gt;;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classStress__Func.html#a0bf8c91e94c442771847d430721a1d7d">  142</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1resize__memory__op.html">resmem_complex_h_op</a> = <a class="code" href="structpsi_1_1memory_1_1resize__memory__op.html">psi::memory::resize_memory_op&lt;std::complex&lt;FPTYPE&gt;</a>, psi::DEVICE_CPU&gt;;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classStress__Func.html#aabab3112912a54326824dc5babc47d8f">  143</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1set__memory__op.html">setmem_complex_op</a> = <a class="code" href="structpsi_1_1memory_1_1set__memory__op.html">psi::memory::set_memory_op&lt;std::complex&lt;FPTYPE&gt;</a>, Device&gt;;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classStress__Func.html#a4e62cf88b144e0999d89cf338891d072">  144</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1delete__memory__op.html">delmem_complex_op</a> = <a class="code" href="structpsi_1_1memory_1_1delete__memory__op.html">psi::memory::delete_memory_op&lt;std::complex&lt;FPTYPE&gt;</a>, Device&gt;;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classStress__Func.html#ad135a3f524b4004ebc2f80df8164b6cc">  145</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1delete__memory__op.html">delmem_complex_h_op</a> = <a class="code" href="structpsi_1_1memory_1_1delete__memory__op.html">psi::memory::delete_memory_op&lt;std::complex&lt;FPTYPE&gt;</a>, psi::DEVICE_CPU&gt;;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classStress__Func.html#ac7c67283ce3627b1559b8458eaabd86d">  146</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">syncmem_complex_h2d_op</a> = <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">psi::memory::synchronize_memory_op&lt;std::complex&lt;FPTYPE&gt;</a>, Device, psi::DEVICE_CPU&gt;;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classStress__Func.html#ab46b0fa1d9d3a8372f5ea361631aa132">  147</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">syncmem_complex_d2h_op</a> = <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">psi::memory::synchronize_memory_op&lt;std::complex&lt;FPTYPE&gt;</a>, psi::DEVICE_CPU, Device&gt;;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classStress__Func.html#a54a57902003547f51f3a52334e07c54d">  149</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1resize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">resmem_var_op</a> = <a class="code" href="structpsi_1_1memory_1_1resize__memory__op.html">psi::memory::resize_memory_op&lt;FPTYPE, Device&gt;</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classStress__Func.html#ad1d69a70d1f4c3525ca47bc9a3ed4f7c">  150</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1resize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">resmem_var_h_op</a> = <a class="code" href="structpsi_1_1memory_1_1resize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">psi::memory::resize_memory_op&lt;FPTYPE, psi::DEVICE_CPU&gt;</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classStress__Func.html#adf0b54d1921e7151c37a4540bade2cd4">  151</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1set__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">setmem_var_op</a> = <a class="code" href="structpsi_1_1memory_1_1set__memory__op.html">psi::memory::set_memory_op&lt;FPTYPE, Device&gt;</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classStress__Func.html#a9d8851da8fa139b91d47dc44082b23e0">  152</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1delete__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">delmem_var_op</a> = <a class="code" href="structpsi_1_1memory_1_1delete__memory__op.html">psi::memory::delete_memory_op&lt;FPTYPE, Device&gt;</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classStress__Func.html#ae365ca6782b6260f82f5f69dac9c6b79">  153</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1delete__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">delmem_var_h_op</a> = <a class="code" href="structpsi_1_1memory_1_1delete__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">psi::memory::delete_memory_op&lt;FPTYPE, psi::DEVICE_CPU&gt;</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classStress__Func.html#a1ce155884cfc5e6221580f7510b4a867">  154</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_00_01psi_1_1DEVICE__CPU_01_4.html">syncmem_var_h2d_op</a> = <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">psi::memory::synchronize_memory_op&lt;FPTYPE, Device, psi::DEVICE_CPU&gt;</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classStress__Func.html#a973394a1a700d77c52ca30b2c5edbfba">  155</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_00_01psi_1_1DEVICE__CPU_01_4.html">syncmem_var_d2h_op</a> = <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">psi::memory::synchronize_memory_op&lt;FPTYPE, psi::DEVICE_CPU, Device&gt;</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classStress__Func.html#a4c84c26c58a8a6e22f066d4a68825e0f">  157</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1resize__memory__op.html">resmem_int_op</a> = <a class="code" href="structpsi_1_1memory_1_1resize__memory__op.html">psi::memory::resize_memory_op&lt;int, Device&gt;</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classStress__Func.html#a42ae3cb475676432b23a631d9bb64659">  158</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1delete__memory__op.html">delmem_int_op</a> = <a class="code" href="structpsi_1_1memory_1_1delete__memory__op.html">psi::memory::delete_memory_op&lt;int, Device&gt;</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classStress__Func.html#a1b1ea57265396779b37b1e1a1089e0ee">  159</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">syncmem_int_h2d_op</a> = <a class="code" href="structpsi_1_1memory_1_1synchronize__memory__op.html">psi::memory::synchronize_memory_op&lt;int, Device, psi::DEVICE_CPU&gt;</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;};</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructpsi_1_1memory_1_1delete__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4_html"><div class="ttname"><a href="structpsi_1_1memory_1_1delete__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">psi::memory::delete_memory_op&lt; FPTYPE, psi::DEVICE_CPU &gt;</a></div><div class="ttdef"><b>Definition:</b> memory_op.cpp:67</div></div>
<div class="ttc" id="aclassModuleBase_1_1realArray_html"><div class="ttname"><a href="classModuleBase_1_1realArray.html">ModuleBase::realArray</a></div><div class="ttdoc">double float array</div><div class="ttdef"><b>Definition:</b> realarray.h:25</div></div>
<div class="ttc" id="astructpsi_1_1memory_1_1synchronize__memory__op_html"><div class="ttname"><a href="structpsi_1_1memory_1_1synchronize__memory__op.html">psi::memory::synchronize_memory_op</a></div><div class="ttdef"><b>Definition:</b> memory_op.h:44</div></div>
<div class="ttc" id="aclassStress__Func_html_a8321bc531e273ed3b268c1e397b790a7"><div class="ttname"><a href="classStress__Func.html#a8321bc531e273ed3b268c1e397b790a7">Stress_Func::stress_invalid_threshold_ev</a></div><div class="ttdeci">static FPTYPE stress_invalid_threshold_ev</div><div class="ttdef"><b>Definition:</b> stress_func.h:130</div></div>
<div class="ttc" id="aclassStress__Func_html_a04e4fa436039813323bde6c2bfcb2d5f"><div class="ttname"><a href="classStress__Func.html#a04e4fa436039813323bde6c2bfcb2d5f">Stress_Func::stress_loc</a></div><div class="ttdeci">void stress_loc(ModuleBase::matrix &amp;sigma, ModulePW::PW_Basis *rho_basis, const bool is_pw, const Charge *const chr)</div><div class="ttdef"><b>Definition:</b> stress_func_loc.cpp:10</div></div>
<div class="ttc" id="amath__kernel__op_8h_html"><div class="ttname"><a href="math__kernel__op_8h.html">math_kernel_op.h</a></div></div>
<div class="ttc" id="aclassStress__Func_html_a6fc9b89334a17ad363da53de60e88ea8"><div class="ttname"><a href="classStress__Func.html#a6fc9b89334a17ad363da53de60e88ea8">Stress_Func::stress_gga</a></div><div class="ttdeci">void stress_gga(ModuleBase::matrix &amp;sigma, const Charge *const chr)</div><div class="ttdef"><b>Definition:</b> stress_func_gga.cpp:8</div></div>
<div class="ttc" id="astructhamilt_1_1cal__stress__nl__op_html"><div class="ttname"><a href="structhamilt_1_1cal__stress__nl__op.html">hamilt::cal_stress_nl_op</a></div><div class="ttdef"><b>Definition:</b> stress_op.h:52</div></div>
<div class="ttc" id="anamespaceModuleBase_1_1libm_html_a947b87f10e3327eefe6c05e187d544d6"><div class="ttname"><a href="namespaceModuleBase_1_1libm.html#a947b87f10e3327eefe6c05e187d544d6">ModuleBase::libm::x</a></div><div class="ttdeci">double x[440]</div><div class="ttdef"><b>Definition:</b> sincos.cpp:28</div></div>
<div class="ttc" id="arealarray_8h_html"><div class="ttname"><a href="realarray_8h.html">realarray.h</a></div></div>
<div class="ttc" id="aclassModuleBase_1_1Vector3_html"><div class="ttname"><a href="classModuleBase_1_1Vector3.html">ModuleBase::Vector3</a></div><div class="ttdoc">3 elements vector</div><div class="ttdef"><b>Definition:</b> vector3.h:20</div></div>
<div class="ttc" id="aclassStress__Func_html_a1e296d156f33bd3235f89f78d8fe3a13"><div class="ttname"><a href="classStress__Func.html#a1e296d156f33bd3235f89f78d8fe3a13">Stress_Func::Stress_Func</a></div><div class="ttdeci">Stress_Func()</div><div class="ttdef"><b>Definition:</b> stress_func.h:58</div></div>
<div class="ttc" id="aclassStress__Func_html_a283a801fed548150170fa9626fc7c96a"><div class="ttname"><a href="classStress__Func.html#a283a801fed548150170fa9626fc7c96a">Stress_Func::printstress_total</a></div><div class="ttdeci">void printstress_total(const ModuleBase::matrix &amp;scs, bool ry)</div><div class="ttdef"><b>Definition:</b> stress_func_print.cpp:61</div></div>
<div class="ttc" id="aclasspsi_1_1Psi_html"><div class="ttname"><a href="classpsi_1_1Psi.html">psi::Psi</a></div><div class="ttdef"><b>Definition:</b> psi.h:37</div></div>
<div class="ttc" id="astructpsi_1_1memory_1_1resize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4_html"><div class="ttname"><a href="structpsi_1_1memory_1_1resize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">psi::memory::resize_memory_op&lt; FPTYPE, psi::DEVICE_CPU &gt;</a></div><div class="ttdef"><b>Definition:</b> memory_op.cpp:12</div></div>
<div class="ttc" id="aclassStress__Func_html_a670c5826121cb330454b8d47a22fac36"><div class="ttname"><a href="classStress__Func.html#a670c5826121cb330454b8d47a22fac36">Stress_Func::dvloc_coul</a></div><div class="ttdeci">void dvloc_coul(const FPTYPE &amp;zp, FPTYPE *dvloc, ModulePW::PW_Basis *rho_basis)</div><div class="ttdef"><b>Definition:</b> stress_func_loc.cpp:262</div></div>
<div class="ttc" id="aclassModuleBase_1_1matrix_html"><div class="ttname"><a href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a></div><div class="ttdef"><b>Definition:</b> matrix.h:18</div></div>
<div class="ttc" id="astructhamilt_1_1cal__dbecp__noevc__nl__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4_html"><div class="ttname"><a href="structhamilt_1_1cal__dbecp__noevc__nl__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">hamilt::cal_dbecp_noevc_nl_op&lt; FPTYPE, psi::DEVICE_CPU &gt;</a></div><div class="ttdef"><b>Definition:</b> stress_op.cpp:6</div></div>
<div class="ttc" id="astructpsi_1_1memory_1_1resize__memory__op_html"><div class="ttname"><a href="structpsi_1_1memory_1_1resize__memory__op.html">psi::memory::resize_memory_op</a></div><div class="ttdef"><b>Definition:</b> memory_op.h:16</div></div>
<div class="ttc" id="aclassStress__Func_html_a6b372e8c27086b15272a7998ff2f90e1"><div class="ttname"><a href="classStress__Func.html#a6b372e8c27086b15272a7998ff2f90e1">Stress_Func::Polynomial_Interpolation_nl</a></div><div class="ttdeci">FPTYPE Polynomial_Interpolation_nl(const ModuleBase::realArray &amp;table, const int &amp;dim1, const int &amp;dim2, const FPTYPE &amp;table_interval, const FPTYPE &amp;x)</div><div class="ttdef"><b>Definition:</b> stress_func_nl.cpp:498</div></div>
<div class="ttc" id="aclassModuleBase_1_1ComplexMatrix_html"><div class="ttname"><a href="classModuleBase_1_1ComplexMatrix.html">ModuleBase::ComplexMatrix</a></div><div class="ttdef"><b>Definition:</b> complexmatrix.h:13</div></div>
<div class="ttc" id="astructhamilt_1_1cal__dbecp__noevc__nl__op_html"><div class="ttname"><a href="structhamilt_1_1cal__dbecp__noevc__nl__op.html">hamilt::cal_dbecp_noevc_nl_op</a></div><div class="ttdef"><b>Definition:</b> stress_op.h:10</div></div>
<div class="ttc" id="astructpsi_1_1memory_1_1synchronize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_00_01psi_1_1DEVICE__CPU_01_4_html"><div class="ttname"><a href="structpsi_1_1memory_1_1synchronize__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_00_01psi_1_1DEVICE__CPU_01_4.html">psi::memory::synchronize_memory_op&lt; FPTYPE, psi::DEVICE_CPU, psi::DEVICE_CPU &gt;</a></div><div class="ttdef"><b>Definition:</b> memory_op.cpp:43</div></div>
<div class="ttc" id="aclassStress__Func_html"><div class="ttname"><a href="classStress__Func.html">Stress_Func</a></div><div class="ttdef"><b>Definition:</b> stress_func.h:54</div></div>
<div class="ttc" id="aclassStress__Func_html_a50b50093a32d06c086fb6c15d5bc40f9"><div class="ttname"><a href="classStress__Func.html#a50b50093a32d06c086fb6c15d5bc40f9">Stress_Func::~Stress_Func</a></div><div class="ttdeci">~Stress_Func()</div><div class="ttdef"><b>Definition:</b> stress_func.h:59</div></div>
<div class="ttc" id="astructhsolver_1_1gemm__op_html"><div class="ttname"><a href="structhsolver_1_1gemm__op.html">hsolver::gemm_op</a></div><div class="ttdef"><b>Definition:</b> math_kernel_op.h:247</div></div>
<div class="ttc" id="amatrix_8h_html"><div class="ttname"><a href="matrix_8h.html">matrix.h</a></div></div>
<div class="ttc" id="aclassStress__Func_html_a124c45025fb8cdda7ff05c4bfd6a48bb"><div class="ttname"><a href="classStress__Func.html#a124c45025fb8cdda7ff05c4bfd6a48bb">Stress_Func::stress_har</a></div><div class="ttdeci">void stress_har(ModuleBase::matrix &amp;sigma, ModulePW::PW_Basis *rho_basis, const bool is_pw, const Charge *const chr)</div><div class="ttdef"><b>Definition:</b> stress_func_har.cpp:8</div></div>
<div class="ttc" id="aparallel__reduce_8h_html"><div class="ttname"><a href="parallel__reduce_8h.html">parallel_reduce.h</a></div></div>
<div class="ttc" id="aclassStress__Func_html_a9cd596f677abbca0995744fc15e5dc8d"><div class="ttname"><a href="classStress__Func.html#a9cd596f677abbca0995744fc15e5dc8d">Stress_Func::ctx</a></div><div class="ttdeci">Device * ctx</div><div class="ttdef"><b>Definition:</b> stress_func.h:134</div></div>
<div class="ttc" id="aclassStress__Func_html_abd558c6392aac372a1509345bfed1220"><div class="ttname"><a href="classStress__Func.html#abd558c6392aac372a1509345bfed1220">Stress_Func::get_dvnl2</a></div><div class="ttdeci">void get_dvnl2(ModuleBase::ComplexMatrix &amp;vkb, const int ik)</div><div class="ttdef"><b>Definition:</b> stress_func_nl.cpp:406</div></div>
<div class="ttc" id="apw__basis_8h_html"><div class="ttname"><a href="pw__basis_8h.html">pw_basis.h</a></div></div>
<div class="ttc" id="astructpsi_1_1memory_1_1set__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4_html"><div class="ttname"><a href="structpsi_1_1memory_1_1set__memory__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">psi::memory::set_memory_op&lt; FPTYPE, psi::DEVICE_CPU &gt;</a></div><div class="ttdef"><b>Definition:</b> memory_op.cpp:36</div></div>
<div class="ttc" id="aclassStress__Func_html_a0ec0c4ec6ec0bfd4af78d5b1c21a14f0"><div class="ttname"><a href="classStress__Func.html#a0ec0c4ec6ec0bfd4af78d5b1c21a14f0">Stress_Func::print_stress</a></div><div class="ttdeci">void print_stress(const std::string &amp;name, const ModuleBase::matrix &amp;f, const bool screen, bool ry) const</div><div class="ttdef"><b>Definition:</b> stress_func_print.cpp:9</div></div>
<div class="ttc" id="astructhsolver_1_1gemm__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4_html"><div class="ttname"><a href="structhsolver_1_1gemm__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">hsolver::gemm_op&lt; FPTYPE, psi::DEVICE_CPU &gt;</a></div><div class="ttdef"><b>Definition:</b> math_kernel_op.cpp:143</div></div>
<div class="ttc" id="aclassStress__Func_html_a56db0ba4eff8f3f0a5281f1d78ba7362"><div class="ttname"><a href="classStress__Func.html#a56db0ba4eff8f3f0a5281f1d78ba7362">Stress_Func::deriv_drhoc</a></div><div class="ttdeci">void deriv_drhoc(const bool &amp;numeric, const int mesh, const FPTYPE *r, const FPTYPE *rab, const FPTYPE *rhoc, FPTYPE *drhocg, ModulePW::PW_Basis *rho_basis)</div><div class="ttdef"><b>Definition:</b> stress_func_cc.cpp:193</div></div>
<div class="ttc" id="astructpsi_1_1memory_1_1delete__memory__op_html"><div class="ttname"><a href="structpsi_1_1memory_1_1delete__memory__op.html">psi::memory::delete_memory_op</a></div><div class="ttdef"><b>Definition:</b> memory_op.h:84</div></div>
<div class="ttc" id="astress__op_8h_html"><div class="ttname"><a href="stress__op_8h.html">stress_op.h</a></div></div>
<div class="ttc" id="aglobal__function_8h_html"><div class="ttname"><a href="global__function_8h.html">global_function.h</a></div></div>
<div class="ttc" id="aclassStress__Func_html_afbee9ab8ae59adc80732a946f0cd7449"><div class="ttname"><a href="classStress__Func.html#afbee9ab8ae59adc80732a946f0cd7449">Stress_Func::device</a></div><div class="ttdeci">psi::AbacusDevice_t device</div><div class="ttdef"><b>Definition:</b> stress_func.h:136</div></div>
<div class="ttc" id="aglobal__variable_8h_html"><div class="ttname"><a href="global__variable_8h.html">global_variable.h</a></div></div>
<div class="ttc" id="astructpsi_1_1memory_1_1set__memory__op_html"><div class="ttname"><a href="structpsi_1_1memory_1_1set__memory__op.html">psi::memory::set_memory_op</a></div><div class="ttdef"><b>Definition:</b> memory_op.h:30</div></div>
<div class="ttc" id="acharge_8h_html"><div class="ttname"><a href="charge_8h.html">charge.h</a></div></div>
<div class="ttc" id="aclassStress__Func_html_a061fef4615b75d29e7354466972d75f2"><div class="ttname"><a href="classStress__Func.html#a061fef4615b75d29e7354466972d75f2">Stress_Func::dvloc_of_g</a></div><div class="ttdeci">void dvloc_of_g(const int &amp;msh, const FPTYPE *rab, const FPTYPE *r, const FPTYPE *vloc_at, const FPTYPE &amp;zp, FPTYPE *dvloc, ModulePW::PW_Basis *rho_basis)</div><div class="ttdef"><b>Definition:</b> stress_func_loc.cpp:162</div></div>
<div class="ttc" id="aclassStress__Func_html_ab56632672a198791eb2eb94cbaafe733"><div class="ttname"><a href="classStress__Func.html#ab56632672a198791eb2eb94cbaafe733">Stress_Func::dylmr2</a></div><div class="ttdeci">void dylmr2(const int nylm, const int ngy, ModuleBase::Vector3&lt; FPTYPE &gt; *gk, ModuleBase::matrix &amp;dylm, const int ipol)</div><div class="ttdef"><b>Definition:</b> stress_func_nl.cpp:526</div></div>
<div class="ttc" id="avector3_8h_html"><div class="ttname"><a href="vector3_8h.html">vector3.h</a></div></div>
<div class="ttc" id="aclassStress__Func_html_ac65ce961e4ab45a1a099e5865f9d44d1"><div class="ttname"><a href="classStress__Func.html#ac65ce961e4ab45a1a099e5865f9d44d1">Stress_Func::get_dvnl1</a></div><div class="ttdeci">void get_dvnl1(ModuleBase::ComplexMatrix &amp;vkb, const int ik, const int ipol)</div><div class="ttdef"><b>Definition:</b> stress_func_nl.cpp:310</div></div>
<div class="ttc" id="apsi_8h_html"><div class="ttname"><a href="psi_8h.html">psi.h</a></div></div>
<div class="ttc" id="acomplexmatrix_8h_html"><div class="ttname"><a href="complexmatrix_8h.html">complexmatrix.h</a></div></div>
<div class="ttc" id="aclassStress__Func_html_a123bfe3d6692f7863c5233b9d6f93215"><div class="ttname"><a href="classStress__Func.html#a123bfe3d6692f7863c5233b9d6f93215">Stress_Func::stress_ewa</a></div><div class="ttdeci">void stress_ewa(ModuleBase::matrix &amp;sigma, ModulePW::PW_Basis *rho_basis, const bool is_pw)</div><div class="ttdef"><b>Definition:</b> stress_func_ewa.cpp:14</div></div>
<div class="ttc" id="aclassStress__Func_html_a50478a2cfc33d323e655d58460853d0f"><div class="ttname"><a href="classStress__Func.html#a50478a2cfc33d323e655d58460853d0f">Stress_Func::cpu_ctx</a></div><div class="ttdeci">psi::DEVICE_CPU * cpu_ctx</div><div class="ttdef"><b>Definition:</b> stress_func.h:135</div></div>
<div class="ttc" id="aclassCharge_html"><div class="ttname"><a href="classCharge.html">Charge</a></div><div class="ttdef"><b>Definition:</b> charge.h:13</div></div>
<div class="ttc" id="aclassStress__Func_html_a00cd2c8bf58fb4579fa89276e4767329"><div class="ttname"><a href="classStress__Func.html#a00cd2c8bf58fb4579fa89276e4767329">Stress_Func::stress_mgga</a></div><div class="ttdeci">void stress_mgga(ModuleBase::matrix &amp;sigma, const ModuleBase::matrix &amp;wg, const ModuleBase::matrix &amp;v_ofk, const Charge *const chr, const psi::Psi&lt; complex&lt; FPTYPE &gt;&gt; *psi_in=nullptr)</div><div class="ttdef"><b>Definition:</b> stress_func_mgga.cpp:8</div></div>
<div class="ttc" id="aclassStress__Func_html_a3872140813071a0b0f2c116f2e66c517"><div class="ttname"><a href="classStress__Func.html#a3872140813071a0b0f2c116f2e66c517">Stress_Func::stress_nl</a></div><div class="ttdeci">void stress_nl(ModuleBase::matrix &amp;sigma, const ModuleBase::matrix &amp;wg, const psi::Psi&lt; complex&lt; FPTYPE &gt;, Device &gt; *psi_in=nullptr)</div><div class="ttdef"><b>Definition:</b> stress_func_nl.cpp:10</div></div>
<div class="ttc" id="astructhamilt_1_1cal__stress__nl__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4_html"><div class="ttname"><a href="structhamilt_1_1cal__stress__nl__op_3_01FPTYPE_00_01psi_1_1DEVICE__CPU_01_4.html">hamilt::cal_stress_nl_op&lt; FPTYPE, psi::DEVICE_CPU &gt;</a></div><div class="ttdef"><b>Definition:</b> stress_op.cpp:64</div></div>
<div class="ttc" id="aclassStress__Func_html_afb4a91cc8729aa125799567996c3870c"><div class="ttname"><a href="classStress__Func.html#afb4a91cc8729aa125799567996c3870c">Stress_Func::stress_cc</a></div><div class="ttdeci">void stress_cc(ModuleBase::matrix &amp;sigma, ModulePW::PW_Basis *rho_basis, const bool is_pw, const Charge *const chr)</div><div class="ttdef"><b>Definition:</b> stress_func_cc.cpp:9</div></div>
<div class="ttc" id="aclassStress__Func_html_a50eb85c062f859d8589b292e7e9a6155"><div class="ttname"><a href="classStress__Func.html#a50eb85c062f859d8589b292e7e9a6155">Stress_Func::output_acc</a></div><div class="ttdeci">static FPTYPE output_acc</div><div class="ttdef"><b>Definition:</b> stress_func.h:131</div></div>
<div class="ttc" id="aclassStress__Func_html_a581c9814b3e779edcba36cf3ff8097f1"><div class="ttname"><a href="classStress__Func.html#a581c9814b3e779edcba36cf3ff8097f1">Stress_Func::stress_kin</a></div><div class="ttdeci">void stress_kin(ModuleBase::matrix &amp;sigma, const ModuleBase::matrix &amp;wg, const psi::Psi&lt; complex&lt; FPTYPE &gt;&gt; *psi_in=nullptr)</div><div class="ttdef"><b>Definition:</b> stress_func_kin.cpp:7</div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html">ModulePW::PW_Basis</a></div><div class="ttdoc">A class which can convert a function of &quot;r&quot; to the corresponding linear superposition of plane waves ...</div><div class="ttdef"><b>Definition:</b> pw_basis.h:53</div></div>
<div class="ttc" id="anamespacepsi_html_ad8c12890ff1eb1ec9ea924e8b8bf00e1"><div class="ttname"><a href="namespacepsi.html#ad8c12890ff1eb1ec9ea924e8b8bf00e1">psi::AbacusDevice_t</a></div><div class="ttdeci">AbacusDevice_t</div><div class="ttdef"><b>Definition:</b> types.h:12</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
