<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3.1.1: module_esolver/esolver_of.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="abacus-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">3.1.1
   &#160;<span id="projectnumber">2023-02-01</span>
   </div>
   <div id="projectbrief">Molecule Simulates the Future</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a30d47de8fecf074abb832c28c2e6d11.html">module_esolver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">esolver_of.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="esolver__of_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef ESOLVER_OF_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define ESOLVER_OF_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="esolver__fp_8h.html">esolver_fp.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="opt__TN_8hpp.html">module_base/opt_TN.hpp</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="opt__DCsrch_8h.html">module_base/opt_DCsrch.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi_8h.html">module_psi/psi.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="charge__extra_8h.html">module_elecstate/module_charge/charge_extra.h</a>&quot;</span>    <span class="comment">// liuyu add 2022-11-07</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kedf__tf_8h.html">module_hamilt_pw/hamilt_ofdft/kedf_tf.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kedf__vw_8h.html">module_hamilt_pw/hamilt_ofdft/kedf_vw.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kedf__wt_8h.html">module_hamilt_pw/hamilt_ofdft/kedf_wt.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="charge_8h.html">module_elecstate/module_charge/charge.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceModuleESolver.html">ModuleESolver</a></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html">   16</a></span>&#160;<span class="keyword">class </span><a class="code" href="classModuleESolver_1_1ESolver__OF.html">ESolver_OF</a>: <span class="keyword">public</span> <a class="code" href="classModuleESolver_1_1ESolver__FP.html">ESolver_FP</a></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// =========== TO DO LIST =============</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// MORE KEDF</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// GAMMA ONLY</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// SPIN POLARISE</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#afd9e3e4a15851666aaf83a7bddbd8c94">   23</a></span>&#160;    <a class="code" href="classpsi_1_1Psi.html">psi::Psi&lt;double&gt;</a>* <a class="code" href="namespacepsi.html">psi</a>=<span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#afb477a325ed82ce6af002bcc7ff56b4c">   25</a></span>&#160;    <a class="code" href="classModuleESolver_1_1ESolver__OF.html#afb477a325ed82ce6af002bcc7ff56b4c">ESolver_OF</a>()</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        this-&gt;<a class="code" href="classModuleESolver_1_1ESolver.html#aefab3a21fea6ca349f41a2533395af99">classname</a> = <span class="stringliteral">&quot;ESolver_OF&quot;</span>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aabcf7485a606aefb57a191a6a0972d0b">task</a> = <span class="keyword">new</span> <span class="keywordtype">char</span>[60];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a6de83cb2249cc3b80505a625455e3fb4">   31</a></span>&#160;    <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a6de83cb2249cc3b80505a625455e3fb4">~ESolver_OF</a>()</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">if</span>(this-&gt;psi != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <span class="keyword">delete</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#afd9e3e4a15851666aaf83a7bddbd8c94">psi</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aaa7a115c561f56fed741243c4690d800">pdirect</a> != NULL)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> = 0; <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> &lt; <a class="code" href="namespaceGlobalV.html#aa21d3bb9a3dd12f2b025fb31ff8cd0ee">GlobalV::NSPIN</a>; ++<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aaa7a115c561f56fed741243c4690d800">pdirect</a>[<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>];</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aaa7a115c561f56fed741243c4690d800">pdirect</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        } </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a87e9c457db6e2532b89a5698cf045e94">pphi</a> != NULL) <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a87e9c457db6e2532b89a5698cf045e94">pphi</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#adad040792fa39f28969c249daa292fde">pdLdphi</a> != NULL)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> = 0; <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> &lt; <a class="code" href="namespaceGlobalV.html#aa21d3bb9a3dd12f2b025fb31ff8cd0ee">GlobalV::NSPIN</a>; ++<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#adad040792fa39f28969c249daa292fde">pdLdphi</a>[<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#adad040792fa39f28969c249daa292fde">pdLdphi</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        } </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ae9bf70332f9771840ffcca79591e1e9e">pdEdphi</a> != NULL)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> = 0; <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> &lt; <a class="code" href="namespaceGlobalV.html#aa21d3bb9a3dd12f2b025fb31ff8cd0ee">GlobalV::NSPIN</a>; ++<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ae9bf70332f9771840ffcca79591e1e9e">pdEdphi</a>[<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>];</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ae9bf70332f9771840ffcca79591e1e9e">pdEdphi</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        } </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a17d98ec3a685056462f80de225be6c03">precipDir</a> != NULL)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code" href="namespaceGlobalV.html#aa21d3bb9a3dd12f2b025fb31ff8cd0ee">GlobalV::NSPIN</a>; ++is)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a17d98ec3a685056462f80de225be6c03">precipDir</a>[is];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a17d98ec3a685056462f80de225be6c03">precipDir</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#acffca2deae06753b765d0172b44a75f3">nelec</a> != NULL) <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#acffca2deae06753b765d0172b44a75f3">nelec</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a23d5ac36b36c70027a294fc67e4efa72">theta</a> != NULL) <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a23d5ac36b36c70027a294fc67e4efa72">theta</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a369b933125a651a0051d68359ea3dfde">mu</a> != NULL) <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a369b933125a651a0051d68359ea3dfde">mu</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aabcf7485a606aefb57a191a6a0972d0b">task</a> != NULL) <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aabcf7485a606aefb57a191a6a0972d0b">task</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ac4fbf384269232a747ae256caf1c019f">opt_cg_mag</a> != NULL) <span class="keyword">delete</span> this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ac4fbf384269232a747ae256caf1c019f">opt_cg_mag</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a9475e8c5873dc90118377c2978123914">Init</a>(<a class="code" href="classInput.html">Input</a> &amp;inp, <a class="code" href="classUnitCell.html">UnitCell</a> &amp;<a class="code" href="namespaceGlobalC.html#ad13900463d5f46ae6dc8854de86b6198">ucell</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a380b40f26c567a678ad6552068e6f4bc">Run</a>(<span class="keywordtype">int</span> <a class="code" href="namespaceIons__Move__Basic.html#afafa0cf5c9a34d577ac34a5a3487cf74">istep</a>, <a class="code" href="classUnitCell.html">UnitCell</a>&amp; <a class="code" href="namespaceGlobalC.html#ad13900463d5f46ae6dc8854de86b6198">ucell</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a8b0d8e899d1364c50332ff8ea5427b1b">postprocess</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a9bd21377904cb71904bd6a05464717c2">cal_Energy</a>(<span class="keywordtype">double</span>&amp; <a class="code" href="namespaceIons__Move__Basic.html#a07e061137b68df3b16c6ec9485db15bd">etot</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a02b9da6593ccf7082ebb1bf279fa5e94">cal_Force</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a> &amp;force) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#acc894b3c6c4e638098cc70caac93bc6e">cal_Stress</a>(<a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a> &amp;stress) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a71e0bab0d2df6f6b63b9a82789c24ed3">   86</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a71e0bab0d2df6f6b63b9a82789c24ed3">getniter</a>()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span> this-&gt;<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ac8a1c5a8876d9bf33973794e90c66dce">iter</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// kinetic energy density functionals</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#ab01318cd23fb76e399cc33dbc17760bd">   92</a></span>&#160;    <a class="code" href="classKEDF__TF.html">KEDF_TF</a> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ab01318cd23fb76e399cc33dbc17760bd">tf</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a1c06b91f2f6abf19b43b24a63f706450">   93</a></span>&#160;    <a class="code" href="classKEDF__vW.html">KEDF_vW</a> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a1c06b91f2f6abf19b43b24a63f706450">vw</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a77d83441d99796c7903d8dfebe7f12aa">   94</a></span>&#160;    <a class="code" href="classKEDF__WT.html">KEDF_WT</a> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a77d83441d99796c7903d8dfebe7f12aa">wt</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// charge extrapolation liuyu add 2022-11-07</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a0a1def57de1245f5407908cb21b0fe1d">   97</a></span>&#160;    <a class="code" href="classCharge__Extra.html">Charge_Extra</a> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a0a1def57de1245f5407908cb21b0fe1d">CE</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// optimization methods</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#ab869f72dc38dad3fda56c2ae22b816a9">  100</a></span>&#160;    <a class="code" href="classModuleBase_1_1Opt__CG.html">ModuleBase::Opt_CG</a> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ab869f72dc38dad3fda56c2ae22b816a9">opt_cg</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a15433bcb7aac52e8e7b4291f149cb8c0">  101</a></span>&#160;    <a class="code" href="classModuleBase_1_1Opt__TN.html">ModuleBase::Opt_TN</a> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a15433bcb7aac52e8e7b4291f149cb8c0">opt_tn</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a4807af76a2f3cceb6ad528a6f90aa732">  102</a></span>&#160;    <a class="code" href="classModuleBase_1_1Opt__DCsrch.html">ModuleBase::Opt_DCsrch</a> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a4807af76a2f3cceb6ad528a6f90aa732">opt_dcsrch</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#ac4fbf384269232a747ae256caf1c019f">  103</a></span>&#160;    <a class="code" href="classModuleBase_1_1Opt__CG.html">ModuleBase::Opt_CG</a> *<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ac4fbf384269232a747ae256caf1c019f">opt_cg_mag</a> = NULL; <span class="comment">// for spin2 case, under testing</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// from Input</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a06f6576b888b24c57ce027711d8c71c1">  106</a></span>&#160;    <span class="keywordtype">string</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a06f6576b888b24c57ce027711d8c71c1">of_kinetic</a> = <span class="stringliteral">&quot;wt&quot;</span>;   <span class="comment">// Kinetic energy functional, such as TF, VW, WT</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a3e7253645f47664f89c3a40401a87f28">  107</a></span>&#160;    <span class="keywordtype">string</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a3e7253645f47664f89c3a40401a87f28">of_method</a> = <span class="stringliteral">&quot;tn&quot;</span>;    <span class="comment">// optimization method, include cg1, cg2, tn (default), bfgs</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a2f425067f2d870ad9f81da15cc769f27">  108</a></span>&#160;    <span class="keywordtype">string</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a2f425067f2d870ad9f81da15cc769f27">of_conv</a> = <span class="stringliteral">&quot;energy&quot;</span>;  <span class="comment">// select the convergence criterion, potential, energy (default), or both</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a0a686f7e4c90142e238d178b043aad01">  109</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a0a686f7e4c90142e238d178b043aad01">of_tole</a> = 2e-6;      <span class="comment">// tolerance of the energy change (in Ry) for determining the convergence, default=2e-6 Ry</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#acedcb7a95ff12aacd03d151ad8a6ee0b">  110</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#acedcb7a95ff12aacd03d151ad8a6ee0b">of_tolp</a> = 1e-5;      <span class="comment">// tolerance of potential for determining the convergence, default=1e-5 in a.u.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#af098646369c086ae1c415da40f07ad80">  111</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#af098646369c086ae1c415da40f07ad80">maxIter</a> = 50;           <span class="comment">// scf_nmax</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// parameters from other module</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a8f926cc631b1e2ac9eca854557caf7a5">  114</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a8f926cc631b1e2ac9eca854557caf7a5">nrxx</a> = 0; <span class="comment">// PWBASIS</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a0c7c7dcd220744972a5a0fdf3c532e77">  115</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a0c7c7dcd220744972a5a0fdf3c532e77">dV</a> = 0; <span class="comment">// CELL</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#acffca2deae06753b765d0172b44a75f3">  116</a></span>&#160;    <span class="keywordtype">double</span> *<a class="code" href="classModuleESolver_1_1ESolver__OF.html#acffca2deae06753b765d0172b44a75f3">nelec</a> = NULL;              <span class="comment">// number of electrons with each spin</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// used in density optimization</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#ac8a1c5a8876d9bf33973794e90c66dce">  119</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ac8a1c5a8876d9bf33973794e90c66dce">iter</a> = 0;                               <span class="comment">// iteration number</span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#aaa7a115c561f56fed741243c4690d800">  120</a></span>&#160;    <span class="keywordtype">double</span> **<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aaa7a115c561f56fed741243c4690d800">pdirect</a> = NULL;                    <span class="comment">// optimization direction of phi, which is sqrt(rho)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a17d98ec3a685056462f80de225be6c03">  121</a></span>&#160;    std::complex&lt;double&gt; **<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a17d98ec3a685056462f80de225be6c03">precipDir</a> = NULL;    <span class="comment">// direction in reciprocal space, used when of_full_pw=false.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a23d5ac36b36c70027a294fc67e4efa72">  122</a></span>&#160;    <span class="keywordtype">double</span> *<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a23d5ac36b36c70027a294fc67e4efa72">theta</a> = NULL;                       <span class="comment">// step length</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#ae9bf70332f9771840ffcca79591e1e9e">  123</a></span>&#160;    <span class="keywordtype">double</span> **<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ae9bf70332f9771840ffcca79591e1e9e">pdEdphi</a> = NULL;                    <span class="comment">// dE/dphi</span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#adad040792fa39f28969c249daa292fde">  124</a></span>&#160;    <span class="keywordtype">double</span> **<a class="code" href="classModuleESolver_1_1ESolver__OF.html#adad040792fa39f28969c249daa292fde">pdLdphi</a> = NULL;                    <span class="comment">// dL/dphi</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a87e9c457db6e2532b89a5698cf045e94">  125</a></span>&#160;    <span class="keywordtype">double</span> **<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a87e9c457db6e2532b89a5698cf045e94">pphi</a> = NULL;                       <span class="comment">// pphi[i] = ppsi.get_pointer(i), which will be freed in ~Psi().</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#aabcf7485a606aefb57a191a6a0972d0b">  126</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="classModuleESolver_1_1ESolver__OF.html#aabcf7485a606aefb57a191a6a0972d0b">task</a> = NULL;                          <span class="comment">// used in line search</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a369b933125a651a0051d68359ea3dfde">  127</a></span>&#160;    <span class="keywordtype">double</span> *<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a369b933125a651a0051d68359ea3dfde">mu</a> = NULL;                          <span class="comment">// chemical potential</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#ac4f6912b45ee4f5117f58b10d2e70bb7">  128</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ac4f6912b45ee4f5117f58b10d2e70bb7">tnSpinFlag</a> = -1;                        <span class="comment">// spin flag used in calV, which will be called by opt_tn</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a24bdbc7172c16b8217bcedd1b379620e">  129</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a24bdbc7172c16b8217bcedd1b379620e">maxDCsrch</a> = 200;                        <span class="comment">// max no. of line search</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a45427e54eb1420dc9bc2c58a49e91bb4">  130</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a45427e54eb1420dc9bc2c58a49e91bb4">flag</a> = -1;                              <span class="comment">// flag of TN</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// // test rho convergence criterion</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// double *pdeltaRhoHar = NULL; // 4pi*rhog/k^2</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// double deltaRhoG = 0.; // 1/2\iint{deltaRho(r)deltaRho(r&#39;)/|r-r&#39;|drdr&#39;}</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// double deltaRhoR = 0.; // \int{|deltaRho(r)|dr}</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// used in convergence check</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#aa829768a3560352463d1e22d859b043f">  138</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#aa829768a3560352463d1e22d859b043f">conv</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#ac6acfe51df544129315175e5c7f1ba27">  139</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ac6acfe51df544129315175e5c7f1ba27">energy_llast</a> = 0;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#af0ad2ade6edd6f9cb451ebeee3e638a0">  140</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#af0ad2ade6edd6f9cb451ebeee3e638a0">energy_last</a> = 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#af27910fbb3f67eb9d99ad7abfd0f1b8b">  141</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#af27910fbb3f67eb9d99ad7abfd0f1b8b">energy_current</a> = 0;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#abb4b5bd10fa409abfbb49d857484bd69">  142</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#abb4b5bd10fa409abfbb49d857484bd69">normdLdphi_llast</a> = 100;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#aedb51676a11e91b59a083cb09aebac04">  143</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#aedb51676a11e91b59a083cb09aebac04">normdLdphi_last</a> = 100;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#aaebe4e26090efcd982d546868dbab381">  144</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#aaebe4e26090efcd982d546868dbab381">normdLdphi</a> = 100.;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// main process of OFDFT</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a6ec31babfb980d30e416d7da856f9de5">beforeOpt</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceIons__Move__Basic.html#afafa0cf5c9a34d577ac34a5a3487cf74">istep</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a943020196b1b7e51f59b29d41f3fab07">updateV</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ab1d19b9ae2f4d976e8a17711186cb0fc">solveV</a>();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a8aa7fa07bf3093ac97a7a0b5f08409c9">getNextDirect</a>();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ad9b16dcc86f0f7173e22de79c2e7dc41">updateRho</a>();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a82dba9155f17961017274ed5d26ea33e">checkExit</a>();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a721b16ef0e12b76994edda266c3ca7b5">printInfo</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ae1092298a9813efc7cdde2af4fa26616">afterOpt</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// tools</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a48a871417b685a63c2a991c0946da88f">calV</a>(<span class="keywordtype">double</span> *ptempPhi, <span class="keywordtype">double</span> *rdLdphi);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a6d682e9c9920857b8fe080e00af461ed">caldEdtheta</a>(<span class="keywordtype">double</span> **ptempPhi, <a class="code" href="classCharge.html">Charge</a>* ptempRho, <span class="keywordtype">double</span> *ptheta, <span class="keywordtype">double</span> *rdEdtheta);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a6b761b0f740ded0e98835fb7c54d33de">cal_mu</a>(<span class="keywordtype">double</span> *<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a87e9c457db6e2532b89a5698cf045e94">pphi</a>, <span class="keywordtype">double</span> *<a class="code" href="classModuleESolver_1_1ESolver__OF.html#ae9bf70332f9771840ffcca79591e1e9e">pdEdphi</a>, <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#acffca2deae06753b765d0172b44a75f3">nelec</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classModuleESolver_1_1ESolver__OF.html#a2c12eec9617213c719ce6d6934a799e0">  160</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a2c12eec9617213c719ce6d6934a799e0">inner_product</a>(<span class="keywordtype">double</span> *pa, <span class="keywordtype">double</span> *pb, <span class="keywordtype">int</span> length, <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a0c7c7dcd220744972a5a0fdf3c532e77">dV</a>=1)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordtype">double</span> innerproduct = 0.;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> = 0; <a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a> &lt; length; ++<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>) innerproduct += pa[<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>] * pb[<a class="code" href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">i</a>];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        innerproduct *= <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a0c7c7dcd220744972a5a0fdf3c532e77">dV</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">return</span> innerproduct;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// interfaces to KEDF</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#a201e7b72fee7a4121755354e916faaab">kineticPotential</a>(<span class="keywordtype">double</span> **prho, <span class="keywordtype">double</span> **<a class="code" href="classModuleESolver_1_1ESolver__OF.html#a87e9c457db6e2532b89a5698cf045e94">pphi</a>, <a class="code" href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a> &amp;rpot);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classModuleESolver_1_1ESolver__OF.html#ab92c9e3b9d6d97aec7f10e3adcba2cd7">kineticEnergy</a>();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;};</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassKEDF__TF_html_a3e1c2de3763c7e9497f26552360b1537"><div class="ttname"><a href="classKEDF__TF.html#a3e1c2de3763c7e9497f26552360b1537">KEDF_TF::TFenergy</a></div><div class="ttdeci">double TFenergy</div><div class="ttdef"><b>Definition:</b> kedf_tf.h:33</div></div>
<div class="ttc" id="aclassKEDF__WT_html_a1947f4c1625cb59213a6c53f3f450a17"><div class="ttname"><a href="classKEDF__WT.html#a1947f4c1625cb59213a6c53f3f450a17">KEDF_WT::set_para</a></div><div class="ttdeci">void set_para(int nx, double dV, double alpha, double beta, double nelec, double tf_weight, double vw_weight, bool read_kernel, std::string kernel_file, ModulePW::PW_Basis *pw_rho)</div><div class="ttdef"><b>Definition:</b> kedf_wt.cpp:7</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a0a1def57de1245f5407908cb21b0fe1d"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a0a1def57de1245f5407908cb21b0fe1d">ModuleESolver::ESolver_OF::CE</a></div><div class="ttdeci">Charge_Extra CE</div><div class="ttdef"><b>Definition:</b> esolver_of.h:97</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a17d98ec3a685056462f80de225be6c03"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a17d98ec3a685056462f80de225be6c03">ModuleESolver::ESolver_OF::precipDir</a></div><div class="ttdeci">std::complex&lt; double &gt; ** precipDir</div><div class="ttdef"><b>Definition:</b> esolver_of.h:121</div></div>
<div class="ttc" id="aclassUnitCell_html"><div class="ttname"><a href="classUnitCell.html">UnitCell</a></div><div class="ttdef"><b>Definition:</b> unitcell.h:21</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a23d5ac36b36c70027a294fc67e4efa72"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a23d5ac36b36c70027a294fc67e4efa72">ModuleESolver::ESolver_OF::theta</a></div><div class="ttdeci">double * theta</div><div class="ttdef"><b>Definition:</b> esolver_of.h:122</div></div>
<div class="ttc" id="aglobal_8h_html"><div class="ttname"><a href="global_8h.html">global.h</a></div></div>
<div class="ttc" id="aclasselecstate_1_1ElecState_html_a80bf78513ea1c2ef4eedc7c98facb8fd"><div class="ttname"><a href="classelecstate_1_1ElecState.html#a80bf78513ea1c2ef4eedc7c98facb8fd">elecstate::ElecState::charge</a></div><div class="ttdeci">Charge * charge</div><div class="ttdef"><b>Definition:</b> elecstate.h:85</div></div>
<div class="ttc" id="aclassInput_html_a59b9578169d73d39b0a8a81d8892b875"><div class="ttname"><a href="classInput.html#a59b9578169d73d39b0a8a81d8892b875">Input::of_method</a></div><div class="ttdeci">string of_method</div><div class="ttdef"><b>Definition:</b> input.h:509</div></div>
<div class="ttc" id="aesolver__fp_8h_html"><div class="ttname"><a href="esolver__fp_8h.html">esolver_fp.h</a></div></div>
<div class="ttc" id="anamespaceIons__Move__Basic_html_afafa0cf5c9a34d577ac34a5a3487cf74"><div class="ttname"><a href="namespaceIons__Move__Basic.html#afafa0cf5c9a34d577ac34a5a3487cf74">Ions_Move_Basic::istep</a></div><div class="ttdeci">int istep</div><div class="ttdef"><b>Definition:</b> ions_move_basic.cpp:8</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_acffca2deae06753b765d0172b44a75f3"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#acffca2deae06753b765d0172b44a75f3">ModuleESolver::ESolver_OF::nelec</a></div><div class="ttdeci">double * nelec</div><div class="ttdef"><b>Definition:</b> esolver_of.h:116</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a380b40f26c567a678ad6552068e6f4bc"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a380b40f26c567a678ad6552068e6f4bc">ModuleESolver::ESolver_OF::Run</a></div><div class="ttdeci">virtual void Run(int istep, UnitCell &amp;ucell) override</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:242</div></div>
<div class="ttc" id="aopt__DCsrch_8h_html"><div class="ttname"><a href="opt__DCsrch_8h.html">opt_DCsrch.h</a></div></div>
<div class="ttc" id="aclasselecstate_1_1Potential_html_a82624e65269613fea89feac06f895966"><div class="ttname"><a href="classelecstate_1_1Potential.html#a82624e65269613fea89feac06f895966">elecstate::Potential::get_fixed_v</a></div><div class="ttdeci">double * get_fixed_v()</div><div class="ttdef"><b>Definition:</b> potential_new.h:136</div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_a743759a9021fc9d1cf570a7499e55b08"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#a743759a9021fc9d1cf570a7499e55b08">ModulePW::PW_Basis::real2recip</a></div><div class="ttdeci">void real2recip(const FPTYPE *in, std::complex&lt; FPTYPE &gt; *out, const bool add=false, const FPTYPE factor=1.0)</div><div class="ttdef"><b>Definition:</b> pw_transform.cpp:68</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a11b83923a8ffec489e97695cba8c0bcf"><div class="ttname"><a href="classCharge__Extra.html#a11b83923a8ffec489e97695cba8c0bcf">Charge_Extra::save_pos_next</a></div><div class="ttdeci">void save_pos_next(const UnitCell &amp;ucell)</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:266</div></div>
<div class="ttc" id="aclassKEDF__WT_html_a962f9248a9ce2e3b4c390747d31829c7"><div class="ttname"><a href="classKEDF__WT.html#a962f9248a9ce2e3b4c390747d31829c7">KEDF_WT::stress</a></div><div class="ttdeci">ModuleBase::matrix stress</div><div class="ttdef"><b>Definition:</b> kedf_wt.h:49</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_aa829768a3560352463d1e22d859b043f"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#aa829768a3560352463d1e22d859b043f">ModuleESolver::ESolver_OF::conv</a></div><div class="ttdeci">bool conv</div><div class="ttdef"><b>Definition:</b> esolver_of.h:138</div></div>
<div class="ttc" id="aclassCharge__Extra_html_ad6b3264e9fc967ef8d745df3250dfa85"><div class="ttname"><a href="classCharge__Extra.html#ad6b3264e9fc967ef8d745df3250dfa85">Charge_Extra::extrapolate_charge</a></div><div class="ttdeci">void extrapolate_charge(Charge *chr)</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:76</div></div>
<div class="ttc" id="aclassKEDF__TF_html_a071e19c1a3251c81961f01b26a3066e5"><div class="ttname"><a href="classKEDF__TF.html#a071e19c1a3251c81961f01b26a3066e5">KEDF_TF::set_para</a></div><div class="ttdeci">void set_para(int nx, double dV, double tf_weight)</div><div class="ttdef"><b>Definition:</b> kedf_tf.cpp:5</div></div>
<div class="ttc" id="anamespaceModuleBase_1_1libm_html_a91c03031eb1d447315c0f37d8251d2ad"><div class="ttname"><a href="namespaceModuleBase_1_1libm.html#a91c03031eb1d447315c0f37d8251d2ad">ModuleBase::libm::sin</a></div><div class="ttdeci">Tp sin(Tp x)</div></div>
<div class="ttc" id="aclassForces_html_a584caa88b74ddc81509a20c1bef91a6d"><div class="ttname"><a href="classForces.html#a584caa88b74ddc81509a20c1bef91a6d">Forces::init</a></div><div class="ttdeci">void init(ModuleBase::matrix &amp;force, const ModuleBase::matrix &amp;wg, const Charge *const chr, const psi::Psi&lt; std::complex&lt; FPTYPE &gt;, Device &gt; *psi_in=nullptr)</div><div class="ttdef"><b>Definition:</b> forces.cpp:27</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__FP_html_aaecc8aaaf43c9d6c01f18ba2e7c2f673"><div class="ttname"><a href="classModuleESolver_1_1ESolver__FP.html#aaecc8aaaf43c9d6c01f18ba2e7c2f673">ModuleESolver::ESolver_FP::pelec</a></div><div class="ttdeci">elecstate::ElecState * pelec</div><div class="ttdef"><b>Definition:</b> esolver_fp.h:19</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a24bdbc7172c16b8217bcedd1b379620e"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a24bdbc7172c16b8217bcedd1b379620e">ModuleESolver::ESolver_OF::maxDCsrch</a></div><div class="ttdeci">int maxDCsrch</div><div class="ttdef"><b>Definition:</b> esolver_of.h:129</div></div>
<div class="ttc" id="aclassKEDF__vW_html"><div class="ttname"><a href="classKEDF__vW.html">KEDF_vW</a></div><div class="ttdef"><b>Definition:</b> kedf_vw.h:11</div></div>
<div class="ttc" id="aclassStructure__Factor_html_a34e384dbd2dca46573ed777b03d7aa1b"><div class="ttname"><a href="classStructure__Factor.html#a34e384dbd2dca46573ed777b03d7aa1b">Structure_Factor::setup_structure_factor</a></div><div class="ttdeci">void setup_structure_factor(UnitCell *Ucell, ModulePW::PW_Basis *rho_basis)</div><div class="ttdef"><b>Definition:</b> structure_factor.cpp:60</div></div>
<div class="ttc" id="aclasselecstate_1_1Potential_html_a057e73ffc79c8fe824eddb244fdf027c"><div class="ttname"><a href="classelecstate_1_1Potential.html#a057e73ffc79c8fe824eddb244fdf027c">elecstate::Potential::get_effective_v</a></div><div class="ttdeci">ModuleBase::matrix &amp; get_effective_v()</div><div class="ttdef"><b>Definition:</b> potential_new.h:67</div></div>
<div class="ttc" id="astructure__factor_8h_html"><div class="ttname"><a href="structure__factor_8h.html">structure_factor.h</a></div></div>
<div class="ttc" id="aclassAtom_html_a002c86a094b08c9cdcc09ae3794fa740"><div class="ttname"><a href="classAtom.html#a002c86a094b08c9cdcc09ae3794fa740">Atom::ncpp</a></div><div class="ttdeci">Atom_pseudo ncpp</div><div class="ttdef"><b>Definition:</b> atom_spec.h:14</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aa21d3bb9a3dd12f2b025fb31ff8cd0ee"><div class="ttname"><a href="namespaceGlobalV.html#aa21d3bb9a3dd12f2b025fb31ff8cd0ee">GlobalV::NSPIN</a></div><div class="ttdeci">int NSPIN</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:39</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__FP_html_a96e060667dc05d29204555bbf0e5088b"><div class="ttname"><a href="classModuleESolver_1_1ESolver__FP.html#a96e060667dc05d29204555bbf0e5088b">ModuleESolver::ESolver_FP::pw_rho</a></div><div class="ttdeci">ModulePW::PW_Basis * pw_rho</div><div class="ttdef"><b>Definition:</b> esolver_fp.h:13</div></div>
<div class="ttc" id="aclassCharge__Extra_html"><div class="ttname"><a href="classCharge__Extra.html">Charge_Extra</a></div><div class="ttdef"><b>Definition:</b> charge_extra.h:13</div></div>
<div class="ttc" id="aclassInput_html"><div class="ttname"><a href="classInput.html">Input</a></div><div class="ttdef"><b>Definition:</b> input.h:13</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__FP_html_aa1be91ac66538c223a7c7a5936170765"><div class="ttname"><a href="classModuleESolver_1_1ESolver__FP.html#aa1be91ac66538c223a7c7a5936170765">ModuleESolver::ESolver_FP::Init</a></div><div class="ttdeci">virtual void Init(Input &amp;inp, UnitCell &amp;cell) override</div><div class="ttdef"><b>Definition:</b> esolver_fp.cpp:20</div></div>
<div class="ttc" id="aclasselecstate_1_1ElecState_html_a8970f18371cd1752de00db4e8adb7532"><div class="ttname"><a href="classelecstate_1_1ElecState.html#a8970f18371cd1752de00db4e8adb7532">elecstate::ElecState::init_nelec_spin</a></div><div class="ttdeci">void init_nelec_spin()</div><div class="ttdef"><b>Definition:</b> elecstate.cpp:32</div></div>
<div class="ttc" id="aclassSymmetry__rho_html_a07f18ddf838d58e02e212ab4eb5563ec"><div class="ttname"><a href="classSymmetry__rho.html#a07f18ddf838d58e02e212ab4eb5563ec">Symmetry_rho::begin</a></div><div class="ttdeci">void begin(const int &amp;spin_now, const Charge &amp;CHR, const ModulePW::PW_Basis *pw, Parallel_Grid &amp;Pgrid, ModuleSymmetry::Symmetry &amp;symm) const</div><div class="ttdef"><b>Definition:</b> symmetry_rho.cpp:14</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_adad040792fa39f28969c249daa292fde"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#adad040792fa39f28969c249daa292fde">ModuleESolver::ESolver_OF::pdLdphi</a></div><div class="ttdeci">double ** pdLdphi</div><div class="ttdef"><b>Definition:</b> esolver_of.h:124</div></div>
<div class="ttc" id="akedf__wt_8h_html"><div class="ttname"><a href="kedf__wt_8h.html">kedf_wt.h</a></div></div>
<div class="ttc" id="asymmetry_8h_html"><div class="ttname"><a href="symmetry_8h.html">symmetry.h</a></div></div>
<div class="ttc" id="anamespaceModuleBase_1_1libm_html_a53ba939830541970fa8cdc6973c806e5"><div class="ttname"><a href="namespaceModuleBase_1_1libm.html#a53ba939830541970fa8cdc6973c806e5">ModuleBase::libm::i</a></div><div class="ttdeci">int4 i[880]</div><div class="ttdef"><b>Definition:</b> sincos.cpp:28</div></div>
<div class="ttc" id="anamespaceGlobalV_html_a391b3af56d90128a29e6a76517d64e48"><div class="ttname"><a href="namespaceGlobalV.html#a391b3af56d90128a29e6a76517d64e48">GlobalV::of_wt_beta</a></div><div class="ttdeci">double of_wt_beta</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:231</div></div>
<div class="ttc" id="aclasspseudopot__cell__vnl_html_abe3df0df3ffb1f6b6acec30bcf1e551a"><div class="ttname"><a href="classpseudopot__cell__vnl.html#abe3df0df3ffb1f6b6acec30bcf1e551a">pseudopot_cell_vnl::init_vnl</a></div><div class="ttdeci">void init_vnl(UnitCell &amp;cell)</div><div class="ttdef"><b>Definition:</b> VNL_in_pw.cpp:436</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_aedb51676a11e91b59a083cb09aebac04"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#aedb51676a11e91b59a083cb09aebac04">ModuleESolver::ESolver_OF::normdLdphi_last</a></div><div class="ttdeci">double normdLdphi_last</div><div class="ttdef"><b>Definition:</b> esolver_of.h:143</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a45427e54eb1420dc9bc2c58a49e91bb4"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a45427e54eb1420dc9bc2c58a49e91bb4">ModuleESolver::ESolver_OF::flag</a></div><div class="ttdeci">int flag</div><div class="ttdef"><b>Definition:</b> esolver_of.h:130</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a16ba5ad95bb6646d39f5565c7c9ed96c"><div class="ttname"><a href="namespaceGlobalC.html#a16ba5ad95bb6646d39f5565c7c9ed96c">GlobalC::ppcell</a></div><div class="ttdeci">pseudopot_cell_vnl ppcell</div><div class="ttdef"><b>Definition:</b> elecstate_lcao_test.cpp:61</div></div>
<div class="ttc" id="ahamilt__pw_8h_html"><div class="ttname"><a href="hamilt__pw_8h.html">hamilt_pw.h</a></div></div>
<div class="ttc" id="aclassOF__Stress__PW_html"><div class="ttname"><a href="classOF__Stress__PW.html">OF_Stress_PW</a></div><div class="ttdef"><b>Definition:</b> of_stress_pw.h:7</div></div>
<div class="ttc" id="aclassCharge_html_ac24cc28a0a745d9dd6df6683ed872abf"><div class="ttname"><a href="classCharge.html#ac24cc28a0a745d9dd6df6683ed872abf">Charge::nrxx</a></div><div class="ttdeci">int nrxx</div><div class="ttdef"><b>Definition:</b> charge.h:92</div></div>
<div class="ttc" id="anamespaceGlobalV_html_ab5306ddc6589799708883f8cb4711ee2"><div class="ttname"><a href="namespaceGlobalV.html#ab5306ddc6589799708883f8cb4711ee2">GlobalV::CALCULATION</a></div><div class="ttdeci">std::string CALCULATION</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:31</div></div>
<div class="ttc" id="akedf__vw_8h_html"><div class="ttname"><a href="kedf__vw_8h.html">kedf_vw.h</a></div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__CG_html_a1e6dc26d40281c80ded1bafb57dcb4de"><div class="ttname"><a href="classModuleBase_1_1Opt__CG.html#a1e6dc26d40281c80ded1bafb57dcb4de">ModuleBase::Opt_CG::allocate</a></div><div class="ttdeci">void allocate(int nx)</div><div class="ttdef"><b>Definition:</b> opt_CG.cpp:34</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a0a686f7e4c90142e238d178b043aad01"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a0a686f7e4c90142e238d178b043aad01">ModuleESolver::ESolver_OF::of_tole</a></div><div class="ttdeci">double of_tole</div><div class="ttdef"><b>Definition:</b> esolver_of.h:109</div></div>
<div class="ttc" id="anamespaceModuleBase_html_acc947819e0ade8c106f7e2cfa044435b"><div class="ttname"><a href="namespaceModuleBase.html#acc947819e0ade8c106f7e2cfa044435b">ModuleBase::Ry_to_eV</a></div><div class="ttdeci">const double Ry_to_eV</div><div class="ttdef"><b>Definition:</b> constants.h:81</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a6ec31babfb980d30e416d7da856f9de5"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a6ec31babfb980d30e416d7da856f9de5">ModuleESolver::ESolver_OF::beforeOpt</a></div><div class="ttdeci">void beforeOpt(const int istep)</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:280</div></div>
<div class="ttc" id="aclassXC__Functional_html_a96f41f239f3058eae26a15d11904bc86"><div class="ttname"><a href="classXC__Functional.html#a96f41f239f3058eae26a15d11904bc86">XC_Functional::set_xc_type</a></div><div class="ttdeci">static void set_xc_type(const std::string xc_func_in)</div><div class="ttdef"><b>Definition:</b> xc_functional.cpp:26</div></div>
<div class="ttc" id="anamespaceGlobalV_html_ab5d3c7c55e12b45dcd87699f0c659098"><div class="ttname"><a href="namespaceGlobalV.html#ab5d3c7c55e12b45dcd87699f0c659098">GlobalV::ofs_warning</a></div><div class="ttdeci">std::ofstream ofs_warning</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:145</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ab92c9e3b9d6d97aec7f10e3adcba2cd7"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ab92c9e3b9d6d97aec7f10e3adcba2cd7">ModuleESolver::ESolver_OF::kineticEnergy</a></div><div class="ttdeci">double kineticEnergy()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:1160</div></div>
<div class="ttc" id="aclassKEDF__vW_html_acc26d93f233aa513adcd5c839c60ec96"><div class="ttname"><a href="classKEDF__vW.html#acc26d93f233aa513adcd5c839c60ec96">KEDF_vW::vWenergy</a></div><div class="ttdeci">double vWenergy</div><div class="ttdef"><b>Definition:</b> kedf_vw.h:34</div></div>
<div class="ttc" id="aclassKEDF__TF_html_a202d0c98ebb4b867810e46afb1d15960"><div class="ttname"><a href="classKEDF__TF.html#a202d0c98ebb4b867810e46afb1d15960">KEDF_TF::tf_potential</a></div><div class="ttdeci">void tf_potential(const double *const *prho, ModuleBase::matrix &amp;rpotential)</div><div class="ttdef"><b>Definition:</b> kedf_tf.cpp:52</div></div>
<div class="ttc" id="anamespaceGlobalV_html_ac7268d38d823475dfe84c7db957e6702"><div class="ttname"><a href="namespaceGlobalV.html#ac7268d38d823475dfe84c7db957e6702">GlobalV::init_chg</a></div><div class="ttdeci">std::string init_chg</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:251</div></div>
<div class="ttc" id="anamespaceGlobalV_html_a13603f8e78f53d638b22a89f8e87580e"><div class="ttname"><a href="namespaceGlobalV.html#a13603f8e78f53d638b22a89f8e87580e">GlobalV::of_tf_weight</a></div><div class="ttdeci">double of_tf_weight</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:228</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a7a61ceb6eab828f832c8d85ab4fdbad3"><div class="ttname"><a href="namespaceGlobalC.html#a7a61ceb6eab828f832c8d85ab4fdbad3">GlobalC::en</a></div><div class="ttdeci">energy en</div><div class="ttdef"><b>Definition:</b> elecstate_lcao_test.cpp:57</div></div>
<div class="ttc" id="aclasspsi_1_1Psi_html"><div class="ttname"><a href="classpsi_1_1Psi.html">psi::Psi&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassKEDF__vW_html_a48141735162de78d94747c5171c391b9"><div class="ttname"><a href="classKEDF__vW.html#a48141735162de78d94747c5171c391b9">KEDF_vW::get_stress</a></div><div class="ttdeci">void get_stress(const double *const *pphi, ModulePW::PW_Basis *pw_rho, double inpt_vWenergy=-1)</div><div class="ttdef"><b>Definition:</b> kedf_vw.cpp:171</div></div>
<div class="ttc" id="aclassCharge__Extra_html_acd4db125a93874b419f207b163e9dd40"><div class="ttname"><a href="classCharge__Extra.html#acd4db125a93874b419f207b163e9dd40">Charge_Extra::update_all_pos</a></div><div class="ttdeci">void update_all_pos(const UnitCell &amp;ucell)</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:278</div></div>
<div class="ttc" id="aclasspseudopot__cell__vnl_html_ab88c9de0acad3b7241757f8116d924ad"><div class="ttname"><a href="classpseudopot__cell__vnl.html#ab88c9de0acad3b7241757f8116d924ad">pseudopot_cell_vnl::init</a></div><div class="ttdeci">void init(const int ntype, const bool allocate_vkb=1)</div><div class="ttdef"><b>Definition:</b> VNL_in_pw.cpp:62</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a8b0d8e899d1364c50332ff8ea5427b1b"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a8b0d8e899d1364c50332ff8ea5427b1b">ModuleESolver::ESolver_OF::postprocess</a></div><div class="ttdeci">virtual void postprocess() override</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:914</div></div>
<div class="ttc" id="aclassH__Ewald__pw_html_aaa3df78758c3e66655104ea70221bc35"><div class="ttname"><a href="classH__Ewald__pw.html#aaa3df78758c3e66655104ea70221bc35">H_Ewald_pw::compute_ewald</a></div><div class="ttdeci">static void compute_ewald(const UnitCell &amp;cell, ModulePW::PW_Basis *rho_basis)</div><div class="ttdef"><b>Definition:</b> H_Ewald_pw.cpp:16</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html">ModuleESolver::ESolver_OF</a></div><div class="ttdef"><b>Definition:</b> esolver_of.h:16</div></div>
<div class="ttc" id="aclassModuleBase_1_1Memory_html_aeb0ee609df8fc31710d8604e8d468ca9"><div class="ttname"><a href="classModuleBase_1_1Memory.html#aeb0ee609df8fc31710d8604e8d468ca9">ModuleBase::Memory::record</a></div><div class="ttdeci">static double record(const std::string &amp;class_name, const std::string &amp;name, const long &amp;n, const std::string &amp;type, const bool accumulate=false)</div><div class="ttdoc">Record memory consumed during computation.</div><div class="ttdef"><b>Definition:</b> memory.cpp:94</div></div>
<div class="ttc" id="aclassCharge_html_a1b9443c156efe51eeabc6ce871670316"><div class="ttname"><a href="classCharge.html#a1b9443c156efe51eeabc6ce871670316">Charge::allocate</a></div><div class="ttdeci">void allocate(const int &amp;nspin_in, const int &amp;nrxx_in, const int &amp;ngmc_in)</div><div class="ttdef"><b>Definition:</b> charge.cpp:72</div></div>
<div class="ttc" id="aclassModuleBase_1_1matrix_html"><div class="ttname"><a href="classModuleBase_1_1matrix.html">ModuleBase::matrix</a></div><div class="ttdef"><b>Definition:</b> matrix.h:18</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a32936b72d786a25e085dbc7d16b42b4b"><div class="ttname"><a href="namespaceGlobalC.html#a32936b72d786a25e085dbc7d16b42b4b">GlobalC::symm</a></div><div class="ttdeci">ModuleSymmetry::Symmetry symm</div><div class="ttdef"><b>Definition:</b> updaterhok_pw_test.h:83</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aa068e99b5522fb4639d7749dcf4e66fb"><div class="ttname"><a href="namespaceGlobalV.html#aa068e99b5522fb4639d7749dcf4e66fb">GlobalV::of_full_pw</a></div><div class="ttdeci">bool of_full_pw</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:234</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a634bfa406fb465e36c86cf4b1d22d21a"><div class="ttname"><a href="namespaceGlobalC.html#a634bfa406fb465e36c86cf4b1d22d21a">GlobalC::Pgrid</a></div><div class="ttdeci">Parallel_Grid Pgrid</div><div class="ttdef"><b>Definition:</b> elecstate_lcao_test.cpp:68</div></div>
<div class="ttc" id="aclassenergy_html_aa4a3cc1757ab3cb58ecaf302aca6efb9"><div class="ttname"><a href="classenergy.html#aa4a3cc1757ab3cb58ecaf302aca6efb9">energy::etot</a></div><div class="ttdeci">double etot</div><div class="ttdef"><b>Definition:</b> energy.h:39</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__TN_html_a484c73432dd059430fcdf1d8456a583c"><div class="ttname"><a href="classModuleBase_1_1Opt__TN.html#a484c73432dd059430fcdf1d8456a583c">ModuleBase::Opt_TN::next_direct</a></div><div class="ttdeci">void next_direct(double *px, double *pgradient, int &amp;flag, double *rdirect, T *t, void(T::*p_calGradient)(double *ptemp_x, double *rtemp_gradient))</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a6b761b0f740ded0e98835fb7c54d33de"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a6b761b0f740ded0e98835fb7c54d33de">ModuleESolver::ESolver_OF::cal_mu</a></div><div class="ttdeci">double cal_mu(double *pphi, double *pdEdphi, double nelec)</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:1030</div></div>
<div class="ttc" id="anamespaceGlobalV_html_a2c553e0d734cf9d2285685a747acd050"><div class="ttname"><a href="namespaceGlobalV.html#a2c553e0d734cf9d2285685a747acd050">GlobalV::of_read_kernel</a></div><div class="ttdeci">bool of_read_kernel</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:236</div></div>
<div class="ttc" id="aelecstate__pw_8h_html"><div class="ttname"><a href="elecstate__pw_8h.html">elecstate_pw.h</a></div></div>
<div class="ttc" id="aclassForces_html"><div class="ttname"><a href="classForces.html">Forces&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_ac379e6508d3345239dba8f48f2008c57"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#ac379e6508d3345239dba8f48f2008c57">ModulePW::PW_Basis::nxyz</a></div><div class="ttdeci">int nxyz</div><div class="ttdef"><b>Definition:</b> pw_basis.h:232</div></div>
<div class="ttc" id="aclassUnitCell_html_ad0d39d4919135f44ea165dbba619a65e"><div class="ttname"><a href="classUnitCell.html#ad0d39d4919135f44ea165dbba619a65e">UnitCell::latvec</a></div><div class="ttdeci">ModuleBase::Matrix3 latvec</div><div class="ttdef"><b>Definition:</b> unitcell.h:46</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a8f926cc631b1e2ac9eca854557caf7a5"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a8f926cc631b1e2ac9eca854557caf7a5">ModuleESolver::ESolver_OF::nrxx</a></div><div class="ttdeci">int nrxx</div><div class="ttdef"><b>Definition:</b> esolver_of.h:114</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__TN_html_a0436b9aebe76cc3a612e6116e9d006a6"><div class="ttname"><a href="classModuleBase_1_1Opt__TN.html#a0436b9aebe76cc3a612e6116e9d006a6">ModuleBase::Opt_TN::setPara</a></div><div class="ttdeci">void setPara(double dV)</div><div class="ttdef"><b>Definition:</b> opt_TN.hpp:41</div></div>
<div class="ttc" id="anamespaceGlobalC_html_ad13900463d5f46ae6dc8854de86b6198"><div class="ttname"><a href="namespaceGlobalC.html#ad13900463d5f46ae6dc8854de86b6198">GlobalC::ucell</a></div><div class="ttdeci">UnitCell ucell</div><div class="ttdef"><b>Definition:</b> klist_test.cpp:39</div></div>
<div class="ttc" id="aclassCharge_html_a056fbe36485bdaad061113ab102d66cb"><div class="ttname"><a href="classCharge.html#a056fbe36485bdaad061113ab102d66cb">Charge::rho</a></div><div class="ttdeci">double ** rho</div><div class="ttdef"><b>Definition:</b> charge.h:33</div></div>
<div class="ttc" id="aclasselecstate_1_1ElecState_html_ae2a5e309a4380055007c1b2c1a17d651"><div class="ttname"><a href="classelecstate_1_1ElecState.html#ae2a5e309a4380055007c1b2c1a17d651">elecstate::ElecState::init_scf</a></div><div class="ttdeci">void init_scf(const int istep, const ModuleBase::ComplexMatrix &amp;strucfac)</div><div class="ttdef"><b>Definition:</b> elecstate.cpp:354</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a80055879eba0f2c036c369f16ecfbf3b"><div class="ttname"><a href="namespaceGlobalC.html#a80055879eba0f2c036c369f16ecfbf3b">GlobalC::rhopw</a></div><div class="ttdeci">ModulePW::PW_Basis * rhopw</div><div class="ttdef"><b>Definition:</b> elecstate_lcao_test.cpp:62</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aa6d884dbe6439646b8937a9171e9a8a3"><div class="ttname"><a href="namespaceGlobalV.html#aa6d884dbe6439646b8937a9171e9a8a3">GlobalV::ofs_running</a></div><div class="ttdeci">std::ofstream ofs_running</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:144</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ab1d19b9ae2f4d976e8a17711186cb0fc"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ab1d19b9ae2f4d976e8a17711186cb0fc">ModuleESolver::ESolver_OF::solveV</a></div><div class="ttdeci">void solveV()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:382</div></div>
<div class="ttc" id="aclassKEDF__vW_html_aaca2f06bcbb0844621d18b7018fd473a"><div class="ttname"><a href="classKEDF__vW.html#aaca2f06bcbb0844621d18b7018fd473a">KEDF_vW::vW_potential</a></div><div class="ttdeci">void vW_potential(const double *const *pphi, ModulePW::PW_Basis *pw_rho, ModuleBase::matrix &amp;rpotential)</div><div class="ttdef"><b>Definition:</b> kedf_vw.cpp:100</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_abb4b5bd10fa409abfbb49d857484bd69"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#abb4b5bd10fa409abfbb49d857484bd69">ModuleESolver::ESolver_OF::normdLdphi_llast</a></div><div class="ttdeci">double normdLdphi_llast</div><div class="ttdef"><b>Definition:</b> esolver_of.h:142</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a3e7253645f47664f89c3a40401a87f28"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a3e7253645f47664f89c3a40401a87f28">ModuleESolver::ESolver_OF::of_method</a></div><div class="ttdeci">string of_method</div><div class="ttdef"><b>Definition:</b> esolver_of.h:107</div></div>
<div class="ttc" id="anamespaceDIAGOTEST_html_a0c8319a6e067c53d82f3f3f210021fa4"><div class="ttname"><a href="namespaceDIAGOTEST.html#a0c8319a6e067c53d82f3f3f210021fa4">DIAGOTEST::npw</a></div><div class="ttdeci">int npw</div><div class="ttdef"><b>Definition:</b> diago_mock.h:12</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a06f6576b888b24c57ce027711d8c71c1"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a06f6576b888b24c57ce027711d8c71c1">ModuleESolver::ESolver_OF::of_kinetic</a></div><div class="ttdeci">string of_kinetic</div><div class="ttdef"><b>Definition:</b> esolver_of.h:106</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__DCsrch_html_a8dc195a583657651f32f3198a23f03a8"><div class="ttname"><a href="classModuleBase_1_1Opt__DCsrch.html#a8dc195a583657651f32f3198a23f03a8">ModuleBase::Opt_DCsrch::set_paras</a></div><div class="ttdeci">void set_paras(double ftol=1e-4, double gtol=2e-1, double xtol=1e-12, double stpmin=0., double stpmax=ModuleBase::PI)</div><div class="ttdef"><b>Definition:</b> opt_DCsrch.h:41</div></div>
<div class="ttc" id="aclassUnitCell_html_ac6743e54b55c4b646a69806b4d5f2ac5"><div class="ttname"><a href="classUnitCell.html#ac6743e54b55c4b646a69806b4d5f2ac5">UnitCell::omega</a></div><div class="ttdeci">double omega</div><div class="ttdef"><b>Definition:</b> unitcell.h:44</div></div>
<div class="ttc" id="anamespaceGlobalV_html_a5c0653f98dbd4710a878b6d5d8abb0b6"><div class="ttname"><a href="namespaceGlobalV.html#a5c0653f98dbd4710a878b6d5d8abb0b6">GlobalV::VION_IN_H</a></div><div class="ttdeci">int VION_IN_H</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:89</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ab869f72dc38dad3fda56c2ae22b816a9"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ab869f72dc38dad3fda56c2ae22b816a9">ModuleESolver::ESolver_OF::opt_cg</a></div><div class="ttdeci">ModuleBase::Opt_CG opt_cg</div><div class="ttdef"><b>Definition:</b> esolver_of.h:100</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver_html_aefab3a21fea6ca349f41a2533395af99"><div class="ttname"><a href="classModuleESolver_1_1ESolver.html#aefab3a21fea6ca349f41a2533395af99">ModuleESolver::ESolver::classname</a></div><div class="ttdeci">string classname</div><div class="ttdef"><b>Definition:</b> esolver.h:60</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__FP_html_a0c27777cdadad1dead8c8d7645d93ef3"><div class="ttname"><a href="classModuleESolver_1_1ESolver__FP.html#a0c27777cdadad1dead8c8d7645d93ef3">ModuleESolver::ESolver_FP::chr</a></div><div class="ttdeci">Charge chr</div><div class="ttdef"><b>Definition:</b> esolver_fp.h:20</div></div>
<div class="ttc" id="anamespaceIons__Move__Basic_html_a07e061137b68df3b16c6ec9485db15bd"><div class="ttname"><a href="namespaceIons__Move__Basic.html#a07e061137b68df3b16c6ec9485db15bd">Ions_Move_Basic::etot</a></div><div class="ttdeci">double etot</div><div class="ttdef"><b>Definition:</b> ions_move_basic.cpp:11</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a721b16ef0e12b76994edda266c3ca7b5"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a721b16ef0e12b76994edda266c3ca7b5">ModuleESolver::ESolver_OF::printInfo</a></div><div class="ttdeci">void printInfo()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:848</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_aaa7a115c561f56fed741243c4690d800"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#aaa7a115c561f56fed741243c4690d800">ModuleESolver::ESolver_OF::pdirect</a></div><div class="ttdeci">double ** pdirect</div><div class="ttdef"><b>Definition:</b> esolver_of.h:120</div></div>
<div class="ttc" id="aclassSymmetry__rho_html"><div class="ttname"><a href="classSymmetry__rho.html">Symmetry_rho</a></div><div class="ttdef"><b>Definition:</b> symmetry_rho.h:9</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a3be8e71a6d0c4c49d9540bff85036871"><div class="ttname"><a href="classCharge__Extra.html#a3be8e71a6d0c4c49d9540bff85036871">Charge_Extra::Init_CE</a></div><div class="ttdeci">void Init_CE()</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:29</div></div>
<div class="ttc" id="aclassInput_html_aa05ab79081c96934dbef56535549d588"><div class="ttname"><a href="classInput.html#aa05ab79081c96934dbef56535549d588">Input::of_tolp</a></div><div class="ttdeci">double of_tolp</div><div class="ttdef"><b>Definition:</b> input.h:512</div></div>
<div class="ttc" id="aclassKEDF__TF_html_ab03e03116fc7169a309fccaabf296836"><div class="ttname"><a href="classKEDF__TF.html#ab03e03116fc7169a309fccaabf296836">KEDF_TF::stress</a></div><div class="ttdeci">ModuleBase::matrix stress</div><div class="ttdef"><b>Definition:</b> kedf_tf.h:34</div></div>
<div class="ttc" id="aclassenergy_html_ac71c7a87c40659a2a1e87e0861506c3d"><div class="ttname"><a href="classenergy.html#ac71c7a87c40659a2a1e87e0861506c3d">energy::calculate_etot</a></div><div class="ttdeci">void calculate_etot(void)</div><div class="ttdef"><b>Definition:</b> energy.cpp:79</div></div>
<div class="ttc" id="anamespaceGlobalV_html_abda04420dd2e56d7e0c6b7fa3cd891ee"><div class="ttname"><a href="namespaceGlobalV.html#abda04420dd2e56d7e0c6b7fa3cd891ee">GlobalV::nelec</a></div><div class="ttdeci">double nelec</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:253</div></div>
<div class="ttc" id="aclassCharge_html_af43de10c3c08ad3838d9671f52dcf7fe"><div class="ttname"><a href="classCharge.html#af43de10c3c08ad3838d9671f52dcf7fe">Charge::nspin</a></div><div class="ttdeci">int nspin</div><div class="ttdef"><b>Definition:</b> charge.h:94</div></div>
<div class="ttc" id="aclassModuleBase_1_1timer_html_a7d5a9dd381e39259fb92b31a89140206"><div class="ttname"><a href="classModuleBase_1_1timer.html#a7d5a9dd381e39259fb92b31a89140206">ModuleBase::timer::tick</a></div><div class="ttdeci">static void tick(const std::string &amp;class_name_in, const std::string &amp;name_in)</div><div class="ttdoc">Use twice at a time: the first time, set start_flag to false; the second time, calculate the time dur...</div><div class="ttdef"><b>Definition:</b> timer.cpp:66</div></div>
<div class="ttc" id="aclasselecstate_1_1ElecState_html"><div class="ttname"><a href="classelecstate_1_1ElecState.html">elecstate::ElecState</a></div><div class="ttdef"><b>Definition:</b> elecstate.h:12</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ac6acfe51df544129315175e5c7f1ba27"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ac6acfe51df544129315175e5c7f1ba27">ModuleESolver::ESolver_OF::energy_llast</a></div><div class="ttdeci">double energy_llast</div><div class="ttdef"><b>Definition:</b> esolver_of.h:139</div></div>
<div class="ttc" id="aclasselecstate_1_1ElecState_html_a46b8d99b18890ce8015c707a1aeac36d"><div class="ttname"><a href="classelecstate_1_1ElecState.html#a46b8d99b18890ce8015c707a1aeac36d">elecstate::ElecState::pot</a></div><div class="ttdeci">Potential * pot</div><div class="ttdef"><b>Definition:</b> elecstate.h:83</div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_a0a5231435a0d95b3e0f28dbe6428d612"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#a0a5231435a0d95b3e0f28dbe6428d612">ModulePW::PW_Basis::nrxx</a></div><div class="ttdeci">int nrxx</div><div class="ttdef"><b>Definition:</b> pw_basis.h:116</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ae9bf70332f9771840ffcca79591e1e9e"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ae9bf70332f9771840ffcca79591e1e9e">ModuleESolver::ESolver_OF::pdEdphi</a></div><div class="ttdeci">double ** pdEdphi</div><div class="ttdef"><b>Definition:</b> esolver_of.h:123</div></div>
<div class="ttc" id="aclassModuleBase_1_1matrix_html_abc8c011ec78c8d2f2cf98e69227314b0"><div class="ttname"><a href="classModuleBase_1_1matrix.html#abc8c011ec78c8d2f2cf98e69227314b0">ModuleBase::matrix::create</a></div><div class="ttdeci">void create(const int nrow, const int ncol, const bool flag_zero=true)</div><div class="ttdef"><b>Definition:</b> matrix.cpp:130</div></div>
<div class="ttc" id="aclassOF__Stress__PW_html_aac70df38dc093637423bfe19a48011c2"><div class="ttname"><a href="classOF__Stress__PW.html#aac70df38dc093637423bfe19a48011c2">OF_Stress_PW::cal_stress</a></div><div class="ttdeci">void cal_stress(ModuleBase::matrix &amp;sigmatot, ModuleBase::matrix &amp;kinetic_stress, const psi::Psi&lt; complex&lt; double &gt;&gt; *psi_in=nullptr)</div><div class="ttdef"><b>Definition:</b> of_stress_pw.cpp:7</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__DCsrch_html_a65039e1d23d87052f2493dddbe619b60"><div class="ttname"><a href="classModuleBase_1_1Opt__DCsrch.html#a65039e1d23d87052f2493dddbe619b60">ModuleBase::Opt_DCsrch::dcSrch</a></div><div class="ttdeci">void dcSrch(double &amp;f, double &amp;g, double &amp;rstp, char *rtask)</div><div class="ttdef"><b>Definition:</b> opt_DCsrch.cpp:634</div></div>
<div class="ttc" id="anamespaceGlobalV_html_ade669f968b535d6f8e7f2b4d6520ca41"><div class="ttname"><a href="namespaceGlobalV.html#ade669f968b535d6f8e7f2b4d6520ca41">GlobalV::VH_IN_H</a></div><div class="ttdeci">int VH_IN_H</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:88</div></div>
<div class="ttc" id="aclasselecstate_1_1Potential_html"><div class="ttname"><a href="classelecstate_1_1Potential.html">elecstate::Potential</a></div><div class="ttdef"><b>Definition:</b> potential_new.h:43</div></div>
<div class="ttc" id="anamespaceGlobalV_html_a4fef153d689de58e0dacf8929eada2f2"><div class="ttname"><a href="namespaceGlobalV.html#a4fef153d689de58e0dacf8929eada2f2">GlobalV::of_wt_alpha</a></div><div class="ttdeci">double of_wt_alpha</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:230</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a9475e8c5873dc90118377c2978123914"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a9475e8c5873dc90118377c2978123914">ModuleESolver::ESolver_OF::Init</a></div><div class="ttdeci">virtual void Init(Input &amp;inp, UnitCell &amp;ucell) override</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:24</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__CG_html"><div class="ttname"><a href="classModuleBase_1_1Opt__CG.html">ModuleBase::Opt_CG</a></div><div class="ttdef"><b>Definition:</b> opt_CG.h:21</div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_a3dbf762a3c3b282649614bd1cb89d801"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#a3dbf762a3c3b282649614bd1cb89d801">ModulePW::PW_Basis::npw</a></div><div class="ttdeci">int npw</div><div class="ttdef"><b>Definition:</b> pw_basis.h:111</div></div>
<div class="ttc" id="aclassKEDF__vW_html_ad8a6c743a453587edc8fd65e1304ae93"><div class="ttname"><a href="classKEDF__vW.html#ad8a6c743a453587edc8fd65e1304ae93">KEDF_vW::stress</a></div><div class="ttdeci">ModuleBase::matrix stress</div><div class="ttdef"><b>Definition:</b> kedf_vw.h:35</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ac4f6912b45ee4f5117f58b10d2e70bb7"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ac4f6912b45ee4f5117f58b10d2e70bb7">ModuleESolver::ESolver_OF::tnSpinFlag</a></div><div class="ttdeci">int tnSpinFlag</div><div class="ttdef"><b>Definition:</b> esolver_of.h:128</div></div>
<div class="ttc" id="aclasselecstate_1_1ElecState_html_abc0f8023acb26b46d527af7ee4b141e3"><div class="ttname"><a href="classelecstate_1_1ElecState.html#abc0f8023acb26b46d527af7ee4b141e3">elecstate::ElecState::nelec_spin</a></div><div class="ttdeci">std::vector&lt; double &gt; nelec_spin</div><div class="ttdef"><b>Definition:</b> elecstate.h:66</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a87e9c457db6e2532b89a5698cf045e94"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a87e9c457db6e2532b89a5698cf045e94">ModuleESolver::ESolver_OF::pphi</a></div><div class="ttdeci">double ** pphi</div><div class="ttdef"><b>Definition:</b> esolver_of.h:125</div></div>
<div class="ttc" id="aclassK__Vectors_html_af0155acd9a4eb60264ffe03b346a1e26"><div class="ttname"><a href="classK__Vectors.html#af0155acd9a4eb60264ffe03b346a1e26">K_Vectors::set</a></div><div class="ttdeci">void set(const ModuleSymmetry::Symmetry &amp;symm, const std::string &amp;k_file_name, const int &amp;nspin, const ModuleBase::Matrix3 &amp;reciprocal_vec, const ModuleBase::Matrix3 &amp;latvec)</div><div class="ttdef"><b>Definition:</b> klist.cpp:44</div></div>
<div class="ttc" id="anamespaceGlobalV_html_a4d48fe8d42db51ba5e3f8a15f530f4d8"><div class="ttname"><a href="namespaceGlobalV.html#a4d48fe8d42db51ba5e3f8a15f530f4d8">GlobalV::global_kpoint_card</a></div><div class="ttdeci">std::string global_kpoint_card</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:131</div></div>
<div class="ttc" id="aglobal__function_8h_html"><div class="ttname"><a href="global__function_8h.html">global_function.h</a></div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_afd9e3e4a15851666aaf83a7bddbd8c94"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#afd9e3e4a15851666aaf83a7bddbd8c94">ModuleESolver::ESolver_OF::psi</a></div><div class="ttdeci">psi::Psi&lt; double &gt; * psi</div><div class="ttdef"><b>Definition:</b> esolver_of.h:23</div></div>
<div class="ttc" id="anamespaceModuleBase_1_1libm_html_a7b49e155799ac36b2da1da35b6c2c77c"><div class="ttname"><a href="namespaceModuleBase_1_1libm.html#a7b49e155799ac36b2da1da35b6c2c77c">ModuleBase::libm::cos</a></div><div class="ttdeci">Tp cos(Tp x)</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_aaebe4e26090efcd982d546868dbab381"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#aaebe4e26090efcd982d546868dbab381">ModuleESolver::ESolver_OF::normdLdphi</a></div><div class="ttdeci">double normdLdphi</div><div class="ttdef"><b>Definition:</b> esolver_of.h:144</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a8aa7fa07bf3093ac97a7a0b5f08409c9"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a8aa7fa07bf3093ac97a7a0b5f08409c9">ModuleESolver::ESolver_OF::getNextDirect</a></div><div class="ttdeci">void getNextDirect()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:669</div></div>
<div class="ttc" id="aclassInput_html_aabd887c8705b67a00a671621962a0b6d"><div class="ttname"><a href="classInput.html#aabd887c8705b67a00a671621962a0b6d">Input::of_tole</a></div><div class="ttdeci">double of_tole</div><div class="ttdef"><b>Definition:</b> input.h:511</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a2f425067f2d870ad9f81da15cc769f27"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a2f425067f2d870ad9f81da15cc769f27">ModuleESolver::ESolver_OF::of_conv</a></div><div class="ttdeci">string of_conv</div><div class="ttdef"><b>Definition:</b> esolver_of.h:108</div></div>
<div class="ttc" id="aforces_8h_html"><div class="ttname"><a href="forces_8h.html">forces.h</a></div></div>
<div class="ttc" id="aclassInput_html_ad257e2036bf621eb23d5b82f8ab76532"><div class="ttname"><a href="classInput.html#ad257e2036bf621eb23d5b82f8ab76532">Input::of_kinetic</a></div><div class="ttdeci">string of_kinetic</div><div class="ttdef"><b>Definition:</b> input.h:508</div></div>
<div class="ttc" id="acharge_8h_html"><div class="ttname"><a href="charge_8h.html">charge.h</a></div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ae1092298a9813efc7cdde2af4fa26616"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ae1092298a9813efc7cdde2af4fa26616">ModuleESolver::ESolver_OF::afterOpt</a></div><div class="ttdeci">void afterOpt()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:885</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a77d83441d99796c7903d8dfebe7f12aa"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a77d83441d99796c7903d8dfebe7f12aa">ModuleESolver::ESolver_OF::wt</a></div><div class="ttdeci">KEDF_WT wt</div><div class="ttdef"><b>Definition:</b> esolver_of.h:94</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a6de83cb2249cc3b80505a625455e3fb4"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a6de83cb2249cc3b80505a625455e3fb4">ModuleESolver::ESolver_OF::~ESolver_OF</a></div><div class="ttdeci">~ESolver_OF()</div><div class="ttdef"><b>Definition:</b> esolver_of.h:31</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a4807af76a2f3cceb6ad528a6f90aa732"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a4807af76a2f3cceb6ad528a6f90aa732">ModuleESolver::ESolver_OF::opt_dcsrch</a></div><div class="ttdeci">ModuleBase::Opt_DCsrch opt_dcsrch</div><div class="ttdef"><b>Definition:</b> esolver_of.h:102</div></div>
<div class="ttc" id="acharge__extra_8h_html"><div class="ttname"><a href="charge__extra_8h.html">charge_extra.h</a></div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_acedcb7a95ff12aacd03d151ad8a6ee0b"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#acedcb7a95ff12aacd03d151ad8a6ee0b">ModuleESolver::ESolver_OF::of_tolp</a></div><div class="ttdeci">double of_tolp</div><div class="ttdef"><b>Definition:</b> esolver_of.h:110</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_af0ad2ade6edd6f9cb451ebeee3e638a0"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#af0ad2ade6edd6f9cb451ebeee3e638a0">ModuleESolver::ESolver_OF::energy_last</a></div><div class="ttdeci">double energy_last</div><div class="ttdef"><b>Definition:</b> esolver_of.h:140</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aadbb1c5774927c13a9418447d92657e4"><div class="ttname"><a href="namespaceGlobalV.html#aadbb1c5774927c13a9418447d92657e4">GlobalV::global_out_dir</a></div><div class="ttdeci">std::string global_out_dir</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:139</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a15433bcb7aac52e8e7b4291f149cb8c0"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a15433bcb7aac52e8e7b4291f149cb8c0">ModuleESolver::ESolver_OF::opt_tn</a></div><div class="ttdeci">ModuleBase::Opt_TN opt_tn</div><div class="ttdef"><b>Definition:</b> esolver_of.h:101</div></div>
<div class="ttc" id="aclasselecstate_1_1Potential_html_a297c2e2ff9ecb2103d5b99219f00604a"><div class="ttname"><a href="classelecstate_1_1Potential.html#a297c2e2ff9ecb2103d5b99219f00604a">elecstate::Potential::update_from_charge</a></div><div class="ttdeci">void update_from_charge(const Charge *chg, const UnitCell *ucell)</div><div class="ttdef"><b>Definition:</b> potential_new.cpp:179</div></div>
<div class="ttc" id="avariable__cell_8h_html"><div class="ttname"><a href="variable__cell_8h.html">variable_cell.h</a></div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__CG_html_a71cc1877b3b89adcdb3344f183ea1ed4"><div class="ttname"><a href="classModuleBase_1_1Opt__CG.html#a71cc1877b3b89adcdb3344f183ea1ed4">ModuleBase::Opt_CG::next_direct</a></div><div class="ttdeci">void next_direct(double *pgradient, int label, double *rdirect)</div><div class="ttdef"><b>Definition:</b> opt_CG.cpp:84</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a9bd21377904cb71904bd6a05464717c2"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a9bd21377904cb71904bd6a05464717c2">ModuleESolver::ESolver_OF::cal_Energy</a></div><div class="ttdeci">virtual void cal_Energy(double &amp;etot) override</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:1042</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a1a5abf4c9f6c4ab19f0f65a82322428b"><div class="ttname"><a href="namespaceGlobalC.html#a1a5abf4c9f6c4ab19f0f65a82322428b">GlobalC::sf</a></div><div class="ttdeci">Structure_Factor sf</div><div class="ttdef"><b>Definition:</b> elecstate_lcao_test.cpp:58</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a02b9da6593ccf7082ebb1bf279fa5e94"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a02b9da6593ccf7082ebb1bf279fa5e94">ModuleESolver::ESolver_OF::cal_Force</a></div><div class="ttdeci">virtual void cal_Force(ModuleBase::matrix &amp;force) override</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:1060</div></div>
<div class="ttc" id="aH__Ewald__pw_8h_html"><div class="ttname"><a href="H__Ewald__pw_8h.html">H_Ewald_pw.h</a></div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ab01318cd23fb76e399cc33dbc17760bd"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ab01318cd23fb76e399cc33dbc17760bd">ModuleESolver::ESolver_OF::tf</a></div><div class="ttdeci">KEDF_TF tf</div><div class="ttdef"><b>Definition:</b> esolver_of.h:92</div></div>
<div class="ttc" id="anamespacepsi_html"><div class="ttname"><a href="namespacepsi.html">psi</a></div><div class="ttdef"><b>Definition:</b> device.cpp:20</div></div>
<div class="ttc" id="anamespaceGlobalV_html_a7bf8fbdabaa244ab6724acbf836bde55"><div class="ttname"><a href="namespaceGlobalV.html#a7bf8fbdabaa244ab6724acbf836bde55">GlobalV::GATE_FLAG</a></div><div class="ttdeci">bool GATE_FLAG</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:35</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aa8358ade7703a44273f5d41bf8bedecf"><div class="ttname"><a href="namespaceGlobalV.html#aa8358ade7703a44273f5d41bf8bedecf">GlobalV::of_vw_weight</a></div><div class="ttdeci">double of_vw_weight</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:229</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a2c12eec9617213c719ce6d6934a799e0"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a2c12eec9617213c719ce6d6934a799e0">ModuleESolver::ESolver_OF::inner_product</a></div><div class="ttdeci">double inner_product(double *pa, double *pb, int length, double dV=1)</div><div class="ttdef"><b>Definition:</b> esolver_of.h:160</div></div>
<div class="ttc" id="aclassKEDF__WT_html"><div class="ttname"><a href="classKEDF__WT.html">KEDF_WT</a></div><div class="ttdef"><b>Definition:</b> kedf_wt.h:11</div></div>
<div class="ttc" id="aclassInput_html_a0ec18608ffe56233fc16dc14b70b0f35"><div class="ttname"><a href="classInput.html#a0ec18608ffe56233fc16dc14b70b0f35">Input::scf_nmax</a></div><div class="ttdeci">int scf_nmax</div><div class="ttdef"><b>Definition:</b> input.h:189</div></div>
<div class="ttc" id="aclasspseudopot__cell__vl_html_a19b000b661bdc91b6ae3cdd8d5784e3d"><div class="ttname"><a href="classpseudopot__cell__vl.html#a19b000b661bdc91b6ae3cdd8d5784e3d">pseudopot_cell_vl::init_vloc</a></div><div class="ttdeci">void init_vloc(ModuleBase::matrix &amp;vloc_in, ModulePW::PW_Basis *rho_basis)</div><div class="ttdef"><b>Definition:</b> VL_in_pw.cpp:21</div></div>
<div class="ttc" id="aclasselecstate_1_1Potential_html_a94ccbeaa3dabb988e3380003c26a2bf3"><div class="ttname"><a href="classelecstate_1_1Potential.html#a94ccbeaa3dabb988e3380003c26a2bf3">elecstate::Potential::pot_register</a></div><div class="ttdeci">void pot_register(std::vector&lt; std::string &gt; &amp;components_list)</div><div class="ttdef"><b>Definition:</b> potential_new.cpp:68</div></div>
<div class="ttc" id="aclassKEDF__TF_html_a03022d50c6729b38a7d7579ace9b2f91"><div class="ttname"><a href="classKEDF__TF.html#a03022d50c6729b38a7d7579ace9b2f91">KEDF_TF::get_stress</a></div><div class="ttdeci">void get_stress(double cellVol)</div><div class="ttdef"><b>Definition:</b> kedf_tf.cpp:78</div></div>
<div class="ttc" id="aof__stress__pw_8h_html"><div class="ttname"><a href="of__stress__pw_8h.html">of_stress_pw.h</a></div></div>
<div class="ttc" id="anamespaceGlobalV_html_a03c3ac3e9cea6579cc78c904bc586449"><div class="ttname"><a href="namespaceGlobalV.html#a03c3ac3e9cea6579cc78c904bc586449">GlobalV::out_chg</a></div><div class="ttdeci">int out_chg</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:252</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__FP_html"><div class="ttname"><a href="classModuleESolver_1_1ESolver__FP.html">ModuleESolver::ESolver_FP</a></div><div class="ttdef"><b>Definition:</b> esolver_fp.h:10</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a0c7c7dcd220744972a5a0fdf3c532e77"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a0c7c7dcd220744972a5a0fdf3c532e77">ModuleESolver::ESolver_OF::dV</a></div><div class="ttdeci">double dV</div><div class="ttdef"><b>Definition:</b> esolver_of.h:115</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ac4fbf384269232a747ae256caf1c019f"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ac4fbf384269232a747ae256caf1c019f">ModuleESolver::ESolver_OF::opt_cg_mag</a></div><div class="ttdeci">ModuleBase::Opt_CG * opt_cg_mag</div><div class="ttdef"><b>Definition:</b> esolver_of.h:103</div></div>
<div class="ttc" id="aclassCharge_html_a8155aa32f29524a85eef0cbf1de9d451"><div class="ttname"><a href="classCharge.html#a8155aa32f29524a85eef0cbf1de9d451">Charge::cal_nelec</a></div><div class="ttdeci">void cal_nelec()</div><div class="ttdef"><b>Definition:</b> charge.cpp:1125</div></div>
<div class="ttc" id="anamespaceGlobalV_html_afa698049da4a5443c50813bc5f764470"><div class="ttname"><a href="namespaceGlobalV.html#afa698049da4a5443c50813bc5f764470">GlobalV::of_kernel_file</a></div><div class="ttdeci">std::string of_kernel_file</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:237</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a943020196b1b7e51f59b29d41f3fab07"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a943020196b1b7e51f59b29d41f3fab07">ModuleESolver::ESolver_OF::updateV</a></div><div class="ttdeci">void updateV()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:344</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a6d682e9c9920857b8fe080e00af461ed"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a6d682e9c9920857b8fe080e00af461ed">ModuleESolver::ESolver_OF::caldEdtheta</a></div><div class="ttdeci">void caldEdtheta(double **ptempPhi, Charge *ptempRho, double *ptheta, double *rdEdtheta)</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:1005</div></div>
<div class="ttc" id="apsi_8h_html"><div class="ttname"><a href="psi_8h.html">psi.h</a></div></div>
<div class="ttc" id="aopt__TN_8hpp_html"><div class="ttname"><a href="opt__TN_8hpp.html">opt_TN.hpp</a></div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_afb477a325ed82ce6af002bcc7ff56b4c"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#afb477a325ed82ce6af002bcc7ff56b4c">ModuleESolver::ESolver_OF::ESolver_OF</a></div><div class="ttdeci">ESolver_OF()</div><div class="ttdef"><b>Definition:</b> esolver_of.h:25</div></div>
<div class="ttc" id="aclassKEDF__vW_html_a8418b163e2908b5da1f22834fbf7ef7a"><div class="ttname"><a href="classKEDF__vW.html#a8418b163e2908b5da1f22834fbf7ef7a">KEDF_vW::set_para</a></div><div class="ttdeci">void set_para(int nx, double dV, double vw_weight)</div><div class="ttdef"><b>Definition:</b> kedf_vw.cpp:5</div></div>
<div class="ttc" id="abranred_8cpp_html_abb702d8b501669a23aa0ab3b281b9384"><div class="ttname"><a href="branred_8cpp.html#abb702d8b501669a23aa0ab3b281b9384">min</a></div><div class="ttdeci">#define min(x, y)</div><div class="ttdef"><b>Definition:</b> branred.cpp:18</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_af27910fbb3f67eb9d99ad7abfd0f1b8b"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#af27910fbb3f67eb9d99ad7abfd0f1b8b">ModuleESolver::ESolver_OF::energy_current</a></div><div class="ttdeci">double energy_current</div><div class="ttdef"><b>Definition:</b> esolver_of.h:141</div></div>
<div class="ttc" id="anamespaceGlobalC_html_aa5d1d4815aaeb995c470c456682cecd8"><div class="ttname"><a href="namespaceGlobalC.html#aa5d1d4815aaeb995c470c456682cecd8">GlobalC::bigpw</a></div><div class="ttdeci">ModulePW::PW_Basis_Big * bigpw</div><div class="ttdef"><b>Definition:</b> elecstate_lcao_test.cpp:63</div></div>
<div class="ttc" id="aprint__info_8h_html"><div class="ttname"><a href="print__info_8h.html">print_info.h</a></div></div>
<div class="ttc" id="aclassCharge_html"><div class="ttname"><a href="classCharge.html">Charge</a></div><div class="ttdef"><b>Definition:</b> charge.h:13</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ad9b16dcc86f0f7173e22de79c2e7dc41"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ad9b16dcc86f0f7173e22de79c2e7dc41">ModuleESolver::ESolver_OF::updateRho</a></div><div class="ttdeci">void updateRho()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:740</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__DCsrch_html"><div class="ttname"><a href="classModuleBase_1_1Opt__DCsrch.html">ModuleBase::Opt_DCsrch</a></div><div class="ttdef"><b>Definition:</b> opt_DCsrch.h:13</div></div>
<div class="ttc" id="anamespaceGlobalC_html_a82e5b30ae8436fb8721ae845114b1100"><div class="ttname"><a href="namespaceGlobalC.html#a82e5b30ae8436fb8721ae845114b1100">GlobalC::kv</a></div><div class="ttdeci">K_Vectors kv</div><div class="ttdef"><b>Definition:</b> elecstate_lcao_test.cpp:59</div></div>
<div class="ttc" id="aclassModuleSymmetry_1_1Symmetry_html_a9f7dababf39280c286082252f5107e4f"><div class="ttname"><a href="classModuleSymmetry_1_1Symmetry.html#a9f7dababf39280c286082252f5107e4f">ModuleSymmetry::Symmetry::analy_sys</a></div><div class="ttdeci">void analy_sys(const UnitCell &amp;ucell, std::ofstream &amp;ofs_running)</div><div class="ttdef"><b>Definition:</b> symmetry.cpp:26</div></div>
<div class="ttc" id="anamespaceModuleBase_1_1GlobalFunc_html_a4f5f6148405acc6cf826f88411cbad2a"><div class="ttname"><a href="namespaceModuleBase_1_1GlobalFunc.html#a4f5f6148405acc6cf826f88411cbad2a">ModuleBase::GlobalFunc::DONE</a></div><div class="ttdeci">void DONE(std::ofstream &amp;ofs, const std::string &amp;description, const bool only_rank0)</div><div class="ttdef"><b>Definition:</b> global_function.cpp:82</div></div>
<div class="ttc" id="anamespaceGlobalV_html_aa524458edae98808a282b1a0fab163ad"><div class="ttname"><a href="namespaceGlobalV.html#aa524458edae98808a282b1a0fab163ad">GlobalV::EFIELD_FLAG</a></div><div class="ttdeci">int EFIELD_FLAG</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:33</div></div>
<div class="ttc" id="akedf__tf_8h_html"><div class="ttname"><a href="kedf__tf_8h.html">kedf_tf.h</a></div></div>
<div class="ttc" id="anamespaceGlobalV_html_ad66aa9e97143c0f73ce916226686d333"><div class="ttname"><a href="namespaceGlobalV.html#ad66aa9e97143c0f73ce916226686d333">GlobalV::imp_sol</a></div><div class="ttdeci">bool imp_sol</div><div class="ttdef"><b>Definition:</b> global_variable.cpp:211</div></div>
<div class="ttc" id="aclassKEDF__WT_html_a8efdd2f953c214a234cde7eba4181055"><div class="ttname"><a href="classKEDF__WT.html#a8efdd2f953c214a234cde7eba4181055">KEDF_WT::WTenergy</a></div><div class="ttdeci">double WTenergy</div><div class="ttdef"><b>Definition:</b> kedf_wt.h:47</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a48a871417b685a63c2a991c0946da88f"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a48a871417b685a63c2a991c0946da88f">ModuleESolver::ESolver_OF::calV</a></div><div class="ttdeci">void calV(double *ptempPhi, double *rdLdphi)</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:945</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a71e0bab0d2df6f6b63b9a82789c24ed3"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a71e0bab0d2df6f6b63b9a82789c24ed3">ModuleESolver::ESolver_OF::getniter</a></div><div class="ttdeci">virtual int getniter() override</div><div class="ttdef"><b>Definition:</b> esolver_of.h:86</div></div>
<div class="ttc" id="aclasspseudopot__cell__vnl_html_ae0f902746c26475c2f31e9d0d02e88d3"><div class="ttname"><a href="classpseudopot__cell__vnl.html#ae0f902746c26475c2f31e9d0d02e88d3">pseudopot_cell_vnl::cal_effective_D</a></div><div class="ttdeci">void cal_effective_D()</div><div class="ttdef"><b>Definition:</b> VNL_in_pw.cpp:880</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_ac8a1c5a8876d9bf33973794e90c66dce"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#ac8a1c5a8876d9bf33973794e90c66dce">ModuleESolver::ESolver_OF::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> esolver_of.h:119</div></div>
<div class="ttc" id="anamespaceModuleESolver_html"><div class="ttname"><a href="namespaceModuleESolver.html">ModuleESolver</a></div><div class="ttdef"><b>Definition:</b> esolver.cpp:13</div></div>
<div class="ttc" id="aclassParallel__Grid_html_a09b355aec7fccdd73d19167074797cc4"><div class="ttname"><a href="classParallel__Grid.html#a09b355aec7fccdd73d19167074797cc4">Parallel_Grid::init</a></div><div class="ttdeci">void init(const int &amp;ncx, const int &amp;ncy, const int &amp;ncz, const int &amp;nczp, const int &amp;nrxx, const int &amp;nbz, const int &amp;bz)</div><div class="ttdef"><b>Definition:</b> parallel_grid.cpp:28</div></div>
<div class="ttc" id="aclassInput_html_a66526ee663d849248da2ac997f41a321"><div class="ttname"><a href="classInput.html#a66526ee663d849248da2ac997f41a321">Input::of_conv</a></div><div class="ttdeci">string of_conv</div><div class="ttdef"><b>Definition:</b> input.h:510</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_acc894b3c6c4e638098cc70caac93bc6e"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#acc894b3c6c4e638098cc70caac93bc6e">ModuleESolver::ESolver_OF::cal_Stress</a></div><div class="ttdeci">virtual void cal_Stress(ModuleBase::matrix &amp;stress) override</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:1067</div></div>
<div class="ttc" id="aclassPrint__Info_html_ad01be2043318da8a5be51fd1e91142ab"><div class="ttname"><a href="classPrint__Info.html#ad01be2043318da8a5be51fd1e91142ab">Print_Info::setup_parameters</a></div><div class="ttdeci">static void setup_parameters(UnitCell &amp;ucell, K_Vectors &amp;kv)</div><div class="ttdef"><b>Definition:</b> print_info.cpp:10</div></div>
<div class="ttc" id="asymmetry__rho_8h_html"><div class="ttname"><a href="symmetry__rho_8h.html">symmetry_rho.h</a></div></div>
<div class="ttc" id="aclassCharge_html_ad2ad36da866109a5d8a786e09075b2e8"><div class="ttname"><a href="classCharge.html#ad2ad36da866109a5d8a786e09075b2e8">Charge::rho_core</a></div><div class="ttdeci">double * rho_core</div><div class="ttdef"><b>Definition:</b> charge.h:43</div></div>
<div class="ttc" id="aclassCharge_html_a7af08717d246929ce0c8091838572c9d"><div class="ttname"><a href="classCharge.html#a7af08717d246929ce0c8091838572c9d">Charge::write_rho_cube</a></div><div class="ttdeci">void write_rho_cube(const double *rho_save, const int &amp;is, const std::string &amp;fn, const int &amp;precision=11)</div><div class="ttdef"><b>Definition:</b> write_rho_cube.cpp:5</div></div>
<div class="ttc" id="aesolver__of_8h_html"><div class="ttname"><a href="esolver__of_8h.html">esolver_of.h</a></div></div>
<div class="ttc" id="anamespaceModuleBase_html_a319c957fc399a519aa4cdd447bdee1aa"><div class="ttname"><a href="namespaceModuleBase.html#a319c957fc399a519aa4cdd447bdee1aa">ModuleBase::WARNING_QUIT</a></div><div class="ttdeci">void WARNING_QUIT(const std::string &amp;file, const std::string &amp;description)</div><div class="ttdoc">Combine the functions of WARNING and QUIT.</div><div class="ttdef"><b>Definition:</b> complexmatrix_test.cpp:45</div></div>
<div class="ttc" id="aclassUnitCell_html_a1d93ed6fed7b9031715502ca79504c04"><div class="ttname"><a href="classUnitCell.html#a1d93ed6fed7b9031715502ca79504c04">UnitCell::G</a></div><div class="ttdeci">ModuleBase::Matrix3 G</div><div class="ttdef"><b>Definition:</b> unitcell.h:51</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a82dba9155f17961017274ed5d26ea33e"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a82dba9155f17961017274ed5d26ea33e">ModuleESolver::ESolver_OF::checkExit</a></div><div class="ttdeci">bool checkExit()</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:793</div></div>
<div class="ttc" id="aclassKEDF__WT_html_a4e924af90150938f8d02437af5517043"><div class="ttname"><a href="classKEDF__WT.html#a4e924af90150938f8d02437af5517043">KEDF_WT::get_stress</a></div><div class="ttdeci">void get_stress(double cellVol, const double *const *prho, ModulePW::PW_Basis *pw_rho, double vw_weight)</div><div class="ttdef"><b>Definition:</b> kedf_wt.cpp:155</div></div>
<div class="ttc" id="amemory_8h_html"><div class="ttname"><a href="memory_8h.html">memory.h</a></div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__CG_html_a07bc29d4ec414432d7ef66697d036045"><div class="ttname"><a href="classModuleBase_1_1Opt__CG.html#a07bc29d4ec414432d7ef66697d036045">ModuleBase::Opt_CG::setPara</a></div><div class="ttdeci">void setPara(double dV)</div><div class="ttdef"><b>Definition:</b> opt_CG.cpp:47</div></div>
<div class="ttc" id="aclassUnitCell_html_a1663e041da7d7f723cdf2b19d9d06efe"><div class="ttname"><a href="classUnitCell.html#a1663e041da7d7f723cdf2b19d9d06efe">UnitCell::atoms</a></div><div class="ttdeci">Atom * atoms</div><div class="ttdef"><b>Definition:</b> unitcell.h:24</div></div>
<div class="ttc" id="aclasspseudo__nc_html_a12a5b2583b63a838cc758e1096b8477d"><div class="ttname"><a href="classpseudo__nc.html#a12a5b2583b63a838cc758e1096b8477d">pseudo_nc::xc_func</a></div><div class="ttdeci">std::string xc_func</div><div class="ttdef"><b>Definition:</b> pseudo_nc.h:25</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_aabcf7485a606aefb57a191a6a0972d0b"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#aabcf7485a606aefb57a191a6a0972d0b">ModuleESolver::ESolver_OF::task</a></div><div class="ttdeci">char * task</div><div class="ttdef"><b>Definition:</b> esolver_of.h:126</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__TN_html_abb4706f3c0463e9a07b028671bea4a83"><div class="ttname"><a href="classModuleBase_1_1Opt__TN.html#abb4706f3c0463e9a07b028671bea4a83">ModuleBase::Opt_TN::allocate</a></div><div class="ttdeci">void allocate(int nx)</div><div class="ttdef"><b>Definition:</b> opt_TN.hpp:33</div></div>
<div class="ttc" id="aclassCharge_html_a51bbb47dec561979b532b89a6d6e96e3"><div class="ttname"><a href="classCharge.html#a51bbb47dec561979b532b89a6d6e96e3">Charge::write_rho</a></div><div class="ttdeci">void write_rho(const double *rho_save, const int &amp;is, const int &amp;iter, const std::string &amp;fn, const int &amp;precision=11, const bool for_plot=false)</div><div class="ttdef"><b>Definition:</b> write_rho.cpp:4</div></div>
<div class="ttc" id="aclassKEDF__TF_html"><div class="ttname"><a href="classKEDF__TF.html">KEDF_TF</a></div><div class="ttdef"><b>Definition:</b> kedf_tf.h:13</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a369b933125a651a0051d68359ea3dfde"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a369b933125a651a0051d68359ea3dfde">ModuleESolver::ESolver_OF::mu</a></div><div class="ttdeci">double * mu</div><div class="ttdef"><b>Definition:</b> esolver_of.h:127</div></div>
<div class="ttc" id="anamespaceModuleBase_1_1GlobalFunc_html_ab0d97a1e0e2c8216c3b1cc50cd735056"><div class="ttname"><a href="namespaceModuleBase_1_1GlobalFunc.html#ab0d97a1e0e2c8216c3b1cc50cd735056">ModuleBase::GlobalFunc::ZEROS</a></div><div class="ttdeci">void ZEROS(std::complex&lt; T &gt; *u, const TI n)</div><div class="ttdef"><b>Definition:</b> global_function.h:119</div></div>
<div class="ttc" id="aclassVariable__Cell_html_a734f97e787992db765320371ccd076bb"><div class="ttname"><a href="classVariable__Cell.html#a734f97e787992db765320371ccd076bb">Variable_Cell::init_after_vc</a></div><div class="ttdeci">static void init_after_vc()</div><div class="ttdef"><b>Definition:</b> variable_cell.cpp:8</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_af098646369c086ae1c415da40f07ad80"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#af098646369c086ae1c415da40f07ad80">ModuleESolver::ESolver_OF::maxIter</a></div><div class="ttdeci">int maxIter</div><div class="ttdef"><b>Definition:</b> esolver_of.h:111</div></div>
<div class="ttc" id="aclassModuleSymmetry_1_1Symmetry_html_ada130d6b6ec7688fc9f34100ba17807a"><div class="ttname"><a href="classModuleSymmetry_1_1Symmetry.html#ada130d6b6ec7688fc9f34100ba17807a">ModuleSymmetry::Symmetry::symm_flag</a></div><div class="ttdeci">static int symm_flag</div><div class="ttdef"><b>Definition:</b> symmetry.h:20</div></div>
<div class="ttc" id="aclassModulePW_1_1PW__Basis_html_a44f9ba80877c6b193837f946055319ce"><div class="ttname"><a href="classModulePW_1_1PW__Basis.html#a44f9ba80877c6b193837f946055319ce">ModulePW::PW_Basis::recip2real</a></div><div class="ttdeci">void recip2real(const std::complex&lt; FPTYPE &gt; *in, FPTYPE *out, const bool add=false, const FPTYPE factor=1.0)</div><div class="ttdef"><b>Definition:</b> pw_transform.cpp:189</div></div>
<div class="ttc" id="aclassCharge__Extra_html_a1f12a6b2bda14d862a542abf696d6c81"><div class="ttname"><a href="classCharge__Extra.html#a1f12a6b2bda14d862a542abf696d6c81">Charge_Extra::update_istep</a></div><div class="ttdeci">void update_istep()</div><div class="ttdef"><b>Definition:</b> charge_extra.cpp:272</div></div>
<div class="ttc" id="aclassModuleBase_1_1Opt__TN_html"><div class="ttname"><a href="classModuleBase_1_1Opt__TN.html">ModuleBase::Opt_TN</a></div><div class="ttdef"><b>Definition:</b> opt_TN.hpp:21</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a1c06b91f2f6abf19b43b24a63f706450"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a1c06b91f2f6abf19b43b24a63f706450">ModuleESolver::ESolver_OF::vw</a></div><div class="ttdeci">KEDF_vW vw</div><div class="ttdef"><b>Definition:</b> esolver_of.h:93</div></div>
<div class="ttc" id="aclassModuleESolver_1_1ESolver__OF_html_a201e7b72fee7a4121755354e916faaab"><div class="ttname"><a href="classModuleESolver_1_1ESolver__OF.html#a201e7b72fee7a4121755354e916faaab">ModuleESolver::ESolver_OF::kineticPotential</a></div><div class="ttdeci">void kineticPotential(double **prho, double **pphi, ModuleBase::matrix &amp;rpot)</div><div class="ttdef"><b>Definition:</b> esolver_of.cpp:1108</div></div>
<div class="ttc" id="aclassKEDF__WT_html_af535b0b3344924bbb3b2cf08f961479e"><div class="ttname"><a href="classKEDF__WT.html#af535b0b3344924bbb3b2cf08f961479e">KEDF_WT::WT_potential</a></div><div class="ttdeci">void WT_potential(const double *const *prho, ModulePW::PW_Basis *pw_rho, ModuleBase::matrix &amp;rpotential)</div><div class="ttdef"><b>Definition:</b> kedf_wt.cpp:99</div></div>
<div class="ttc" id="anamespaceParallel__Reduce_html_a084a3fade9af529400c21328d87ba915"><div class="ttname"><a href="namespaceParallel__Reduce.html#a084a3fade9af529400c21328d87ba915">Parallel_Reduce::reduce_double_all</a></div><div class="ttdeci">void reduce_double_all(double &amp;object)</div><div class="ttdef"><b>Definition:</b> parallel_reduce.cpp:27</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
